<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · SymmetricTightBinding.jl</title><meta name="title" content="API · SymmetricTightBinding.jl"/><meta property="og:title" content="API · SymmetricTightBinding.jl"/><meta property="twitter:title" content="API · SymmetricTightBinding.jl"/><meta name="description" content="Documentation for SymmetricTightBinding.jl."/><meta property="og:description" content="Documentation for SymmetricTightBinding.jl."/><meta property="twitter:description" content="Documentation for SymmetricTightBinding.jl."/><meta property="og:url" content="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/api/"/><meta property="twitter:url" content="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/api/"/><link rel="canonical" href="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SymmetricTightBinding.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../band-symmetry/">Band symmetry</a></li><li><a class="tocitem" href="../symmetry-breaking/">Symmetry breaking</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li></ul></li><li><a class="tocitem" href="../internal-api/">Internal API</a></li><li><a class="tocitem" href="../theory/">Theory</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><hr/><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Crystalline.collect_compatible-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, Vararg{Any}}} where D" href="#Crystalline.collect_compatible-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, Vararg{Any}}} where D"><code>Crystalline.collect_compatible</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">collect_compatible(ptbm::ParameterizedTightBindingModel{D}; multiplicities_kws...)</code></pre><p>Determine a decomposition of the bands associated with <code>ptbm</code> into a set of <code>SymmetryVector</code>s, with each symmetry vector corresponding to a set of compatibility-respecting (i.e., energy separable along high-symmetry <strong>k</strong>-lines) bands.</p><p><strong>Keyword arguments</strong></p><ul><li><code>multiplicities_kws...</code>: keyword arguments passed to <code>Crystalline.collect_compatible</code> used in determining the multiplicities of irreps across high-symmetry <strong>k</strong>-points.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Crystalline, SymmetricTightBinding

julia&gt; brs = calc_bandreps(221);

julia&gt; cbr = @composite brs[1] + brs[2]
40-irrep CompositeBandRep{3}:
 (3d|A₁g) + (3d|A₁ᵤ) (6 bands)

julia&gt; tbm = tb_hamiltonian(cbr); # a 4-term, 6-band model

julia&gt; ptbm = tbm([1.0, 0.1, -1.0, 0.1]); # fix free coefficients

julia&gt; collect_compatible(ptbm)
2-element Vector{SymmetryVector{3}}:
 [M₅⁺+M₁⁻, X₃⁺+X₁⁻+X₂⁻, Γ₁⁻+Γ₃⁻, R₄⁺] (3 bands)
 [M₁⁺+M₅⁻, X₁⁺+X₂⁺+X₃⁻, Γ₁⁺+Γ₃⁺, R₄⁻] (3 bands)</code></pre><p>In the above example, the bands separate into two symmetry vectors, one for each of the original EBRs in <code>cbr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/symmetry_analysis.jl#L1-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Crystalline.collect_irrep_annotations-Tuple{ParameterizedTightBindingModel}" href="#Crystalline.collect_irrep_annotations-Tuple{ParameterizedTightBindingModel}"><code>Crystalline.collect_irrep_annotations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">collect_irrep_annotations(ptbm::ParameterizedTightBindingModel; kws...)</code></pre><p>Collect the irrep labels across the high-symmetry <strong>k</strong>-points referenced by the underlying composite band representation of <code>ptbm</code>, across the bands of the model.</p><p>Useful for annotating irrep labels in band structure plots (via the Makie extension call <code>plot(ks, energies; annotations=collect_irrep_annotations(ptbm))</code>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/symmetry_analysis.jl#L137-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.berrycurvature-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Integer}, Tuple{ParameterizedTightBindingModel{D}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Integer, NTuple{D, Matrix{ComplexF64}}}} where D" href="#SymmetricTightBinding.berrycurvature-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Integer}, Tuple{ParameterizedTightBindingModel{D}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Integer, NTuple{D, Matrix{ComplexF64}}}} where D"><code>SymmetricTightBinding.berrycurvature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">berrycurvature(
    ptbm::ParameterizedTightBindingModel{D},
    k::ReciprocalPointLike{D},
    n::Integer,
    [∇Hs::NTuple{D, Matrix{ComplexF64}}]
)  --&gt; Ω</code></pre><p>Compute the Berry curvature <code>Ω</code> of the <code>n</code>th band of the coefficient-parameterized tight-binding model <code>ptbm</code> at the <strong>k</strong>-point <code>k</code>. If <code>D == 3</code>, <code>Ω</code> is a 3-element vector, representing, the three components of the Berry curvature pseudovector <span>$[Ω₁, Ω₂, Ω₃] = [Ω₂₃, Ω₃₁, Ω₁₂]$</span>.  If <code>D == 2</code>, <code>Ω</code> is a scalar, representing the Berry curvature pseudoscalar <span>$Ω₃ = Ω₁₂$</span>.</p><p>The optional <code>∇Hs</code> argument is a tuple of work-matrices used to store the momentum gradient of the Hamiltonian.</p><p><strong>Implementation</strong></p><p>The Berry curvature is evaluated using the Kubo-like or &quot;sum-over-states&quot; formula <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>:</p><p class="math-container">\[\Omega_{ij}^n
=
\sum_{n&#39; \neq n}
\frac{\langle n |\partial H/\partial k_i|n&#39;\rangle \langle n&#39;|\partial H/\partial k_j|n&gt;
       - (j \leftrightarrow i)}
      {(E_n - E_{n&#39;})^2}
=
-2\mathrm{Im} \sum_{n&#39; \neq n}
\frac{\langle n |\partial H/\partial k_i|n&#39;\rangle \langle n&#39;|\partial H/\partial k_j|n&gt;}
      {(E_n - E_{n&#39;})^2},\]</p><p>with <span>$\Omega_{ij}^n$</span> denoting  the Berry curvature tensor component of the <code>n</code>th band and <span>$E_n$</span> denoting the energy of the <code>n</code>th band. The Berry curvature pseudovector and (antisymmetric) tensor components are related by <span>$\Omega_1 = \Omega_{23}$</span>, <span>$\Omega_2 = \Omega_{31}$</span>, and <span>$\Omega_3 = \Omega_{12}$</span>.</p><p>[1]: Xiao, Chang, &amp; Niu, &quot;Berry phase effects on electronic properties&quot;,      <a href="https://doi.org/10.1103/RevModPhys.82.1959">Rev. Mod. Phys. <strong>82</strong>, 1959 (2010)</a> (see     Eq. (1.13)).</p><p><strong>Extended help</strong></p><p>As elsewhere in SymmetricTightBinding.jl, this function operates in <em>reduced</em> coordinates, with the momentum <code>k = (k₁, k₂, k₃)</code> indicating coefficients relative to the primitive reciprocal lattice vectors <span>$\mathbf{b}_i$</span>, i.e., <span>$\mathbf{k} = k_1\mathbf{b}_1 + k_2\mathbf{b}_2 + \ldots$</span>. Crucially, this also implies that returned Berry curvature components are <em>not</em> the Cartesian components, but components relative to the primitive reciprocal basis.</p><p><strong>In 3D</strong>, this implies that the returned vector <code>Ω = [Ω₁, Ω₂, Ω₃]</code> relates to the Berry curvature pseudovector <span>$\boldsymbol{\Omega}$</span> via</p><p class="math-container">\[\boldsymbol{\Omega}
=
V_{\text{BZ}}^{-1} (\Omega_1 \mathbf{b}_1 + \Omega_2 \mathbf{b}_2 + \Omega_3 \mathbf{b}_3)
=
V_{\text{BZ}}^{-1} (\Omega_{23} \mathbf{b}_1 + \Omega_{31} \mathbf{b}_2 + \Omega_{12} \mathbf{b}_3),\]</p><p>with <span>$V_{\text{BZ}} = \mathbf{b}_1 \cdot (\mathbf{b}_2 \times \mathbf{b}_3)$</span> denoting the (signed) volume of the 3D Brillouin zone. Here, the tensor components <span>$\Omega_{12}$</span> etc. correspond to momentum derivatives in the <em>reduced</em> coordinates, i.e., the derivatives <span>$\partial/\partial k_{1,2}$</span> are taken with respect to  reduced (dimensionless) coordinates <span>$k_{1,2}$</span> rather than Cartesian ones.</p><p>As a result, the returned Berry curvature pseudovector components <span>$[Ω₁, Ω₂, Ω₃]$</span> are related to the Cartesian pseudovector components <span>$[Ω_x, Ω_y, Ω_z]$</span> by the primitive reciprocal lattice matrix <span>$\mathbf{B} = [\mathbf{b}_1 \mathbf{b}_2 \mathbf{b}_3]$</span>:</p><p class="math-container">\[[Ω_x, Ω_y, Ω_z]^{\text{T}} = V_{\text{BZ}}^{-1} \mathbf{B} [Ω₁, Ω₂, Ω₃]^{\text{T}}\]</p><p>Equivalently, the antisymmetric Berry curvature tensors <span>$\Omega_{ij}$</span> (<span>$i,j \in \{1, 2, 3\}$</span>, i.e., reduced coordinate basis) and <span>$\Omega_{\mu\nu} ($</span>\mu, \nu =  {x, y, z}``, i.e. Cartesian basis) relates via</p><p class="math-container">\[\Omega_{ij} = \sum_{\mu\nu} B^T_{i\mu} \Omega_{\mu\nu} B_{\nu j}\
\Omega_{\mu\nu} = \sum_{ij} B^{-T}_{\mu i} \Omega_{ij} B^{-1}_{j\nu}.\]</p><p><strong>In 2D</strong>, the returned Berry curvature is a (pseudo)scalar <span>$Ω₃ = Ω₁₂$</span>. Again, this value represents the component of the Berry curvature in the reduced coordinate system. It is related to the Cartesian pseudoscalar <span>$\Omega_{xy}$</span> by the (signed) area of the Brillouin zone <span>$A_{\text{BZ}} = (\mathbf{b}_1 \times \mathbf{b}_2) \cdot  \hat{\mathbf{z}}$</span>:</p><p class="math-container">\[\Omega_z = \Omega_{xy} = \Omega_{12} / A_{\text{BZ}}.\]</p><p><strong>Implications for surface integrals and flux</strong></p><p>When using the returned 3D Berry curvature pseudovector <code>[Ω₁, Ω₂, Ω₃]</code> to calculate physical observables like the Chern number of a slice or the flux through a surface, it&#39;s crucial to integrate the correct physical quantity. The assumed goal is always to compute a flux integral:</p><p class="math-container">\[\Phi = \int_S \boldsymbol{\Omega} \cdot \,\mathrm{d}\mathbf{S}.
````

While this function returns the components `[Ω₁, Ω₂, Ω₃]` in the reduced basis, the flux
integrand requires the full dot product between the physical vector ``\boldsymbol{\Omega}
= \Omega_1 \mathbf{b}_1 + \Omega_2 \mathbf{b}_2 + \Omega_3 \mathbf{b}_3`` and the
physical area element ``\mathrm{d}\mathbf{S}``.

The implications of this statement can be appreciated if we consider e.g., calculating the
Chern number on a planar slice of the BZ, for example the plane spanned by ``\mathbf{b}_1``
and ``\mathbf{b}_2``. The physical area element is ``\mathrm{d}\mathbf{S} = 
(\mathbf{b}_1 \times \mathbf{b}_2) \, \mathrm{d}k_1 \mathrm{d}k_2``, so that the flux
integrand is:
\]</p><p>math \mathrm{d}\Phi = \boldsymbol{\Omega} \cdot d\mathbf{S} = V<em>{\text{BZ}}^{-1}  (\Omega</em>1 \mathbf{b}<em>1 + \Omega</em>2 \mathbf{b}<em>2 + \Omega</em>3 \mathbf{b}<em>3) \cdot (\mathbf{b}</em>1 \times \mathbf{b}<em>2) \, \mathrm{d}k</em>1 \mathrm{d}k_2.</p><pre><code class="language-julia hljs">
By the properties of the triple product, the terms proportional to ``\Omega_{1,2}`` vanish,
leaving:
</code></pre><p>math \mathrm{d}\Phi = V<em>{\text{BZ}}^{-1} \Omega</em>3 (\mathbf{b}<em>3 \cdot (\mathbf{b}</em>1 \times \mathbf{b}<em>2)) \, \mathrm{d}k</em>1 \mathrm{d}k_2.</p><pre><code class="language-julia hljs">
The term `\mathbf{b}_3 \cdot (\mathbf{b}_1 \times \mathbf{b}_2)` is the volume of the
3D Brillouin zone, `V_{\text{BZ}}`, cancelling the `V_{\text{BZ}}^{-1}` prefactor. Thus,
the flux integral simplifies to:
</code></pre><p>math \mathrm{d}\Phi = \Omega<em>3 \, \mathrm{d}k</em>1 \mathrm{d}k_2. ```</p><p>In other words: while the distinction between e.g., <span>$\Omega_{xy}$</span> and <span>$\Omega_{12}$</span> is important for interpreting the curvature at an individual <strong>k</strong>-point, it can be ignored when calculating the Chern number as an integral over the reduced coordinates (e.g.,  <span>$k_{1,2} \in (-1/2, 1/2]$</span> above), since the transformation factors in the curvature and the area element <span>$\mathrm{d}\mathbf{S}$</span> cancel out.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/berry.jl#L1-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.energy_gradient_wrt_hopping-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}}, Tuple{ParameterizedTightBindingModel{D}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Any}} where D" href="#SymmetricTightBinding.energy_gradient_wrt_hopping-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}}, Tuple{ParameterizedTightBindingModel{D}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Any}} where D"><code>SymmetricTightBinding.energy_gradient_wrt_hopping</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_gradient_wrt_hopping(
    ptbm::ParameterizedTightBindingModel{D},
    k::ReciprocalPointLike{D}
    (Es, us) = solve(ptbm, k; bloch_phase=Val(false));
    degen_rtol::Float64 = 1e-12,
    degen_atol::Float64 = 1e-12
) where D</code></pre><p>Return the hopping gradient of the energy of each band in <code>ptbm</code> evaluated at momentum <code>k</code>.</p><p>The gradient is computed using the Feynman-Hellmann theorem. For degenerate bands (assessed energetically using relative and absolute tolerances <code>degen_rtol</code> and <code>degen_atol</code>), a degenerate variant is used, equivalent to degenerate perturbation theory.</p><p>The gradient is returned as column vectors, one for each band, with each column containing the gradient of the corresponding energy with respect to the hopping coefficients of <code>ptbm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/gradients.jl#L32-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.gradient_wrt_hopping-Tuple{TightBindingModel}" href="#SymmetricTightBinding.gradient_wrt_hopping-Tuple{TightBindingModel}"><code>SymmetricTightBinding.gradient_wrt_hopping</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient_wrt_hopping(tbm :: TightBindingModel)
gradient_wrt_hopping(ptbm :: ParameterizedTightBindingModel)</code></pre><p>Return a structure that encodes the gradient of a tight-binding model <code>tbm</code> or <code>ptbm</code> with respect to the hopping coefficients.</p><p>To evaluate the gradient at a particular momentum <code>k</code>, use the returned structure as a functor at <code>k</code>. I.e., <code>gradient(tbm)(k)</code> returns the gradient of the tight-binding Hamiltonian with respect to all hoppping coefficients at momentum <code>k</code>. This gradient is a vector of matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/gradients.jl#L5-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.gradient_wrt_momentum-Union{Tuple{ParameterizedTightBindingModel{D}}, Tuple{D}} where D" href="#SymmetricTightBinding.gradient_wrt_momentum-Union{Tuple{ParameterizedTightBindingModel{D}}, Tuple{D}} where D"><code>SymmetricTightBinding.gradient_wrt_momentum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient_wrt_momentum(ptbm :: ParameterizedTightBindingModel)</code></pre><p>Return a structure that encodes the gradient of a parameterized tight-binding model <code>ptbm</code> with respect to its momentum coordinates (in the basis of the primitive reciprocal lattice vectors)</p><p>To evaluate the gradient at a particular momentum <code>k</code>, use the returned structure as a functor at <code>k</code>. I.e., <code>gradient_wrt_momentum(ptbm)(k)[i]</code> returns the <code>i</code>th component of the momentum derivative of <code>ptbm</code> with respect to the momentum at <code>k</code>. The return value is a <code>D</code>-dimensional tuple of matrices (see also <a href="#SymmetricTightBinding.TightBindingModelMomentumGradient-Union{Tuple{C}, Tuple{D}, Tuple{Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, NTuple{C, Int64}}, Tuple{Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, NTuple{C, Int64}, NTuple{C, Matrix{ComplexF64}}}} where {D, C}"><code>TightBindingModelMomentumGradient</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/gradients.jl#L111-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.obtain_symmetry_related_hoppings-Union{Tuple{V}, Tuple{D}, Tuple{AbstractVector{V}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}} where {D, V&lt;:Union{Crystalline.RVec{D}, AbstractVector{&lt;:Integer}}}" href="#SymmetricTightBinding.obtain_symmetry_related_hoppings-Union{Tuple{V}, Tuple{D}, Tuple{AbstractVector{V}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}} where {D, V&lt;:Union{Crystalline.RVec{D}, AbstractVector{&lt;:Integer}}}"><code>SymmetricTightBinding.obtain_symmetry_related_hoppings</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obtain_symmetry_related_hoppings(
    Rs::AbstractVector{V}, 
    brₐ::NewBandRep{D}, 
    brᵦ::NewBandRep{D};
    diagonal_block::Bool = true,
) --&gt; Vector{HoppingOrbit{D}}</code></pre><p>Compute the symmetry-related hopping terms from the points in the WP of <code>brₐ</code> to the  WP of <code>brᵦ</code>, displaced by a set of primitive lattice-vector representatives <code>Rs</code>.</p><p><strong>Implementation</strong></p><ol><li>Take a point <code>a</code> in the WP of <code>brₐ</code> and a point <code>b</code> in the WP of <code>brᵦ</code>.   Compute the displacement vector <code>δ = b + R - a</code>, where <code>R ∈ Rs</code>.</li><li>If <code>δ ∈ representatives</code>, add <code>δ =&gt; (a, b, R)</code> to the list of hoppings   for that representative and continue. Otherwise, search all representatives for one   whose list of hoppings contains <code>δ =&gt; (a, b, R)</code>. If none is found, add <code>δ</code> as a new   representative and add <code>δ =&gt; (a, b, R)</code> to its list of hoppings.</li><li>Take <code>g ∈ generators</code>, compute <code>δ&#39; = g δ</code> and <code>(a&#39;, b&#39;, R&#39;) = (g a, g b, g R)</code>,   and repeat step 2.</li><li>Repeat steps 1–3 for all pairs of points in the WPs of <code>brₐ</code> and <code>brᵦ</code>.</li></ol><p>Additionally, if we are considering a diagonal block (which must be Hermitian or anti-Hermitian), we check whether orbits that relate <code>δ</code> and <code>-δ</code> are present; if not, we add them.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/tightbinding.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.pin_free!-Tuple{Crystalline.Collection{&lt;:Crystalline.NewBandRep}, AbstractVector{&lt;:Pair{Int64, &lt;:AbstractVector{&lt;:Real}}}}" href="#SymmetricTightBinding.pin_free!-Tuple{Crystalline.Collection{&lt;:Crystalline.NewBandRep}, AbstractVector{&lt;:Pair{Int64, &lt;:AbstractVector{&lt;:Real}}}}"><code>SymmetricTightBinding.pin_free!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pin_free!(
    brs::Collection{NewBandRep{D}},
    idx2αβγ::Pair{Int, &lt;:AbstractVector{&lt;:Real}}
)

pin_free!(
    brs::Collection{NewBandRep{D}},
    idx2αβγs::AbstractVector{&lt;:Pair{Int, &lt;:AbstractVector{&lt;:Real}}}
)</code></pre><p>For <code>idx2αβγ = idx =&gt; αβγ</code>, update <code>brs[idx]</code> such that the free parameters of its associated Wyckoff positions are pinned to <code>αβγ</code>.</p><p>A vector of pairs <code>idx2αβγs</code> can also be provided, to pin multiple distinct band representations.</p><p>See also <a href="../internal-api/#SymmetricTightBinding.pin_free-Union{Tuple{D}, Tuple{Crystalline.NewBandRep{D}, AbstractVector{&lt;:Real}}} where D"><code>pin_free</code></a> for non-mutated input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/utils.jl#L162-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.sgrep_induced_by_siteir-Union{Tuple{D}, Tuple{Union{Crystalline.CompositeBandRep{D}, Crystalline.NewBandRep{D}}, Crystalline.SymOperation{D}}, Tuple{Union{Crystalline.CompositeBandRep{D}, Crystalline.NewBandRep{D}}, Crystalline.SymOperation{D}, Array{Bravais.DirectPoint{D}, 1}}} where D" href="#SymmetricTightBinding.sgrep_induced_by_siteir-Union{Tuple{D}, Tuple{Union{Crystalline.CompositeBandRep{D}, Crystalline.NewBandRep{D}}, Crystalline.SymOperation{D}}, Tuple{Union{Crystalline.CompositeBandRep{D}, Crystalline.NewBandRep{D}}, Crystalline.SymOperation{D}, Array{Bravais.DirectPoint{D}, 1}}} where D"><code>SymmetricTightBinding.sgrep_induced_by_siteir</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sgrep_induced_by_siteir(
    br::Union{NewBandRep, CompositeBandRep},
    op::SymOperation, [positions::Vector{&lt;:DirectPoint}]
)
sgrep_induced_by_siteir(
    tbm::Union{TightBindingModel,ParameterizedTightBindingModel}, op::SymOperation
)
    --&gt; SiteInducedSGRepElement</code></pre><p>Computes the representation matrix of a symmetry operation <code>op</code> induced by the site symmetry group associated with an elementary or composite band representation <code>br</code> , <em>including</em> the global momentum-dependent phase factor, returning a <code>SiteInducedSGRepElement</code>, which is a functor over momentum inputs.</p><p>A (possibly parameterized) tight-binding model <code>tbm</code> can be specified instead of a band representation, in which case the latter is inferred from the former.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/site_representations.jl#L131-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.spectrum-Tuple{ParameterizedTightBindingModel, Any}" href="#SymmetricTightBinding.spectrum-Tuple{ParameterizedTightBindingModel, Any}"><code>SymmetricTightBinding.spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectrum(ptbm::ParameterizedTightBindingModel, ks; transform = identity)</code></pre><p>Evaluate the spectrum, i.e., energies, of the tight-binding model <code>ptbm</code> over an iterable of input momenta <code>ks</code>. </p><p>Energies are returned as a matrix, with rows running over momenta and columns over distinct bands.</p><p><strong>Keyword arguments</strong></p><ul><li><code>transform</code>: a function to apply to the resulting matrix of energies, defaulting to the identity function. This can be used to e.g., convert the energies to a different scaling.</li></ul><p><strong>Example</strong></p><p>As an example, we evaluating the band structure of graphene. Below, we first construct and parameterize a tight-binding model for the the (2b|A₁) EBR in plane group 17, corresponding to the highest-lying orbitals in graphene. Next, we construct a path along high-symmetry directions of the Brillouin zone using <a href="https://github.com/thchr/Brillouin.jl">Brillouin.jl</a>, calculate the spectrum across this path; and finally, plot the band structure using Brillouin and GLMakie (or PlotlyJS):</p><pre><code class="language-julia-repl hljs">julia&gt; using Crystalline, SymmetricTightBinding

julia&gt; brs = calc_bandreps(17, Val(2));

julia&gt; cbr = @composite brs[5]
13-irrep CompositeBandRep{2}:
 (2b|A₁) (2 bands)

julia&gt; ptbm = tb_hamiltonian(cbr, [zeros(Int, dim(cbr))])([0.0, 1.0]);

julia&gt; using Brillouin, GLMakie

julia&gt; kpi = interpolate(irrfbz_path(17, directbasis(17, Val(2))), 100);

julia&gt; plot(kpi, spectrum(ptbm, kpi))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/spectrum.jl#L1-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.spectrum-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, AbstractVector{&lt;:Real}}} where D" href="#SymmetricTightBinding.spectrum-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, AbstractVector{&lt;:Real}}} where D"><code>SymmetricTightBinding.spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectrum(ptbm::ParameterizedTightBindingModel, k::AbstractVector{&lt;:Real})</code></pre><p>Evaluate the spectrum, i.e., energies, of the tight-binding model <code>ptbm</code> at a single momentum <code>k</code>, across all the bands of <code>ptbm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/spectrum.jl#L54-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.subduced_complement-Union{Tuple{D}, Tuple{TightBindingModel{D}, Int64}} where D" href="#SymmetricTightBinding.subduced_complement-Union{Tuple{D}, Tuple{TightBindingModel{D}, Int64}} where D"><code>SymmetricTightBinding.subduced_complement</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subduced_complement(tbm::TightBindingModel{D}, sgnumᴴ::Int; timereversal)
                                                    --&gt; TightBindingModel{D}</code></pre><p>Given a model <code>tbm</code> associated with a space group <span>$G$</span>, determine the new, independent tight-binding terms (i.e., the the orthogonal complement of terms) that become  symmetry-allowed when the model&#39;s space group is reduced to a subgroup <span>$H ≤ G$</span> with space group number <code>sgnumᴴ</code> and time-reversal symmetry <code>timereversal</code>.</p><p>Practically, the function answers the question: which new tight-binding terms become allowed if the symmetry of the model is reduced from space group <span>$G$</span> to subgroup <span>$H$</span>?</p><p><strong>Implementation</strong></p><p>The function computes a basis of allowed tight-binding terms in the subgroup setting <span>$H$</span> by simply restricting the constraints in <span>$G$</span> to generators in <span>$H$</span>. This gives a basis for the tight-binding terms in the subduced <span>$G ↓ H$</span> setting.  The space spanned by this basis is compared to the space spanned in the original model; in particular new terms are identified as the orthogonal complement of the spaces associated with <span>$G ↓ H$</span> relative to <span>$G$</span>.</p><p><strong>Keywords</strong></p><ul><li><code>timereversal::Bool</code>: Specifies whether time-reversal symmetry is present in the subgroup <span>$H$</span>. By default, the presence or absence is inherited from the original model <code>tbm</code>. Note that <code>timereversal</code> must be &quot;lower or equal to&quot; the time-reversal of the original model.</li></ul><p><strong>Example</strong></p><p>It is well-known that the Dirac point of graphene is gapped under mirror and time-reversal symmetry breaking. We can see this by constructing a tight-binding model first for a model of graphene (plane group ⋕17) and then subducing it to a setting without mirror symmetry (plane group ⋕16) and without time-reversal symmetry (<code>timereversal = false</code>). First, we construct the tight-binding model for graphene (via the (2a|A₁) band representation):</p><pre><code class="language-julia-repl hljs">julia&gt; using SymmetricTightBinding, Crystalline

julia&gt; brs = calc_bandreps(17, Val(2); timereversal = true);

julia&gt; cbr = @composite brs[5]

julia&gt; tbm = tb_hamiltonian(cbr, [[0,0], [1,0]])</code></pre><p>Each of the 4 terms in this model is proportional to an identity matrix at K = (1/3, 1/3). Using <code>subduced_complement</code>, we can find the new terms that appear if we imagine lowering the symmetry from plane group ⋕17 to ⋕16 (which has no mirror symmetry) while also removing time-reversal symmetry.</p><pre><code class="language-julia-repl hljs">julia&gt; Δtbm = subduced_complement(tbm, 16; timereversal = false)
2-term 2×2 TightBindingModel{2} over (2b|A₁):
┌─
1. ⎡ i𝕖(δ₁)+i𝕖(δ₂)+i𝕖(δ₃)-i𝕖(δ₄)-i𝕖(δ₅)-i𝕖(δ₆)  0                                          ⎤
│  ⎣ 0                                          -i𝕖(δ₁)-i𝕖(δ₂)-i𝕖(δ₃)+i𝕖(δ₄)+i𝕖(δ₅)+i𝕖(δ₆) ⎦
└─ (2b|A₁) self-term:  δ₁=[1,0], δ₂=[0,1], δ₃=[-1,-1], δ₄=-δ₁, δ₅=-δ₂, δ₆=-δ₃
┌─
2. ⎡ 0                                       𝕖(δ₁)+𝕖(δ₂)+𝕖(δ₃)-𝕖(δ₇)-𝕖(δ₈)-𝕖(δ₉) ⎤
│  ⎣ 𝕖(δ₄)+𝕖(δ₅)+𝕖(δ₆)-𝕖(δ₁₀)-𝕖(δ₁₁)-𝕖(δ₁₂)  0                                   ⎦
└─ (2b|A₁) self-term:  δ₁=[4/3,-1/3], δ₂=[1/3,5/3], δ₃=[-5/3,-4/3], δ₄=-δ₁, δ₅=-δ₂, δ₆=-δ₃, δ₇=[1/3,-4/3], δ₈=[-5/3,-1/3], δ₉=[4/3,5/3], δ₁₀=-δ₇, δ₁₁=-δ₈, δ₁₂=-δ₉</code></pre><p>The first of the of these terms is not diagonal at K and so opens a gap at the Dirac point:</p><pre><code class="language-julia-repl hljs">julia&gt; Δtbm[1](ReciprocalPoint(1/3, 1/3))
2×2 Matrix{ComplexF64}:
 5.19615+1.73195e-14im       0.0+0.0im
     0.0+0.0im          -5.19615+1.43774e-14im</code></pre><p><strong>Adding symmetry-breaking terms to the original model</strong></p><p>To build a &quot;complete&quot; model, with both the original and symmetry-breaking terms, use <code>vcat</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; tbm′ = vcat(tbm, Δtbm); length(tbm′) == length(tbm) + length(Δtbm)
true</code></pre><p><strong>Limitations</strong></p><p>The subgroup <span>$H$</span> must be a volume-preserving subgroup of the original group <span>$G$</span>. I.e. <span>$H$</span> must be a translationen-gleiche subgroup of <span>$G$</span> (or <span>$G$</span> itself), and there must exist a transformation from <span>$G$</span> to <span>$H$</span> that preserves volume (i.e., has <code>det(t.P) == 1</code> for <code>t</code> denoting an element returned by Crystalline.jl&#39;s <code>conjugacy_relations</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/symmetry_breaking.jl#L1-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.symmetry_eigenvalues-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, AbstractArray{Crystalline.SymOperation{D}, 1}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}}, Tuple{ParameterizedTightBindingModel{D}, AbstractArray{Crystalline.SymOperation{D}, 1}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, AbstractArray{SymmetricTightBinding.SiteInducedSGRepElement{D}, 1}}} where D" href="#SymmetricTightBinding.symmetry_eigenvalues-Union{Tuple{D}, Tuple{ParameterizedTightBindingModel{D}, AbstractArray{Crystalline.SymOperation{D}, 1}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}}, Tuple{ParameterizedTightBindingModel{D}, AbstractArray{Crystalline.SymOperation{D}, 1}, Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, AbstractArray{SymmetricTightBinding.SiteInducedSGRepElement{D}, 1}}} where D"><code>SymmetricTightBinding.symmetry_eigenvalues</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">symmetry_eigenvalues(
    ptbm::ParameterizedTightBindingModel{D},
    ops::AbstractVector{SymOperation{D}},
    k::ReciprocalPointLike{D},
    [sgreps::AbstractVector{SiteInducedSGRepElement{D}}]
)
symmetry_eigenvalues(
    ptbm::ParameterizedTightBindingModel{D},
    lg::LittleGroup{D},
    [sgreps::AbstractVector{SiteInducedSGRepElement{D}}]
)
    --&gt; Matrix{ComplexF64}</code></pre><p>Compute the symmetry eigenvalues of a coefficient-parameterized tight-binding model <code>ptbm</code> at the <strong>k</strong>-point <code>k</code> for the symmetry operations <code>ops</code>. A <code>LittleGroup</code> can also be provided instead of <code>ops</code> and <code>k</code>.</p><p>Representations of the symmetry operations <code>ops</code> as acting on the orbitals of the tight-binding setting can optionally be provided in <code>sgreps</code> (see <code>sgrep_induced_by_siteir</code>) and are otherwise initialized by the function.</p><p>The symmetry eigenvalues are returned as a matrix, with rows running over the elements of <code>ops</code> and columns running over the bands of <code>ptbm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/symmetry_analysis.jl#L62-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.tb_hamiltonian-Union{Tuple{Crystalline.CompositeBandRep{D}}, Tuple{D}, Tuple{Crystalline.CompositeBandRep{D}, AbstractVector{Vector{Int64}}}} where D" href="#SymmetricTightBinding.tb_hamiltonian-Union{Tuple{Crystalline.CompositeBandRep{D}}, Tuple{D}, Tuple{Crystalline.CompositeBandRep{D}, AbstractVector{Vector{Int64}}}} where D"><code>SymmetricTightBinding.tb_hamiltonian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tb_hamiltonian(cbr::CompositeBandRep{D}, Rs::AbstractVector{Vector{Int}}) 
    --&gt; Vector{TightBindingTerm{D}}</code></pre><p>Construct the TB Hamiltonian matrix from a given composite band representation <code>cbr</code> and a set of global translation-representatives <code>Rs</code>. The Hamiltonian is constructed block by block according to the symmetry-related hoppings between the band representations in <code>cbr</code>. Several models returned, each representing a term that is closed under the symmetry operations of  the underlying space group.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/tightbinding.jl#L848-L858">source</a></section></article><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.HoppingOrbit" href="#SymmetricTightBinding.HoppingOrbit"><code>SymmetricTightBinding.HoppingOrbit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HoppingOrbit{D}</code></pre><p>A structure holding information about symmetry-related spatial hopping vectors.</p><p>An orbit includes all symmetry related vectors {δ} = {δ₁, δ₂, …} obtained by applying the symmetry operations of the underlying space group to a representative vector δ.</p><p>For each element of the orbit δᵢ there may be multiple hopping terms, from site <code>a</code> to site <code>b</code>, possibly related by a lattice translation <code>R</code>. Each such set of possible hopping term <code>(a, b, R)</code> is for each <code>δᵢ</code> is stored elements as the <code>i</code>th element of the vector <code>hoppings</code>.</p><p><strong>Fields</strong></p><ul><li><code>representative :: RVec{D}</code>: the representative hopping vector δ</li><li><code>orbit :: Vector{RVec{D}}</code>: the δᵢ elements of the orbit generated by δ. Generally <code>orbit[1] == representative</code>, i.e., <code>δ₁ = δ</code></li><li><code>hoppings :: Vector{Vector{NTuple{3,RVec{D}}}}</code>: the <code>i</code>th element gives the possible physical hopping terms <code>(a,b,R)</code> associated to <code>orbit[i]</code>. Multiple physical hopping terms may correspond to each element of the orbit.  For <code>(a, b, R) = hoppings[i][j]</code>, we have <code>orbit[i] = δᵢ = b + R - a</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/types.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.ParameterizedTightBindingModel" href="#SymmetricTightBinding.ParameterizedTightBindingModel"><code>SymmetricTightBinding.ParameterizedTightBindingModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ParameterizedTightBindingModel{D}</code></pre><p>A coefficient-parameterized tight-binding model, that can be used as a functor for evaluation at input momenta <code>k</code>.</p><p><strong>Fields</strong></p><ul><li><code>tbm :: TightBindingModel{D}</code>: A tight-binding model, consisting of a set of a list of <code>TightBindingTerm{D}</code>s.</li><li><code>cs :: Vector{Float64}</code>: A vector of coefficients, each associated to a corresponding element of <code>tbm</code>.</li><li><code>scratch :: Matrix{ComplexF64}</code>: A scratch space for evaluating the Hamiltonian matrix at at specific momenta. This is a <code>N×N</code> matrix, where <code>N</code> is the number of orbitals in <code>tbm</code> (i.e., <code>tbm.N</code>). The scratch space is instantiated automatically on construction.</li></ul><p><strong>Functor over momenta</strong></p><p>A <code>ParameterizedTightBindingModel</code> <code>ptbm</code> can be be evaluated at any ´D<code>-dimensional momentum</code>k<code>by using</code>ptbm<code>as a functor. That is,</code>ptbm(k)<code>returns a numerical representation of the Hamiltonian matrix for</code>ptbm<code>evaluated at momentum</code>k<code>.</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/types.jl#L322-L343">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.TightBindingElementString" href="#SymmetricTightBinding.TightBindingElementString"><code>SymmetricTightBinding.TightBindingElementString</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TightBindingElementString</code></pre><p>A structure for pretty-printing tight-binding matrix elements.</p><p><strong>Fields</strong></p><ul><li><code>s :: String</code>: the string representing the tight-binding matrix element</li><li><code>active :: Bool</code>: whether the element belongs to an &quot;active&quot; block - i.e., one we want to highlight (then shown in blue).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/types.jl#L46-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.TightBindingModel" href="#SymmetricTightBinding.TightBindingModel"><code>SymmetricTightBinding.TightBindingModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TightBindingModel{D}</code></pre><p>A structure storing a list of <code>TightBindingTerm{D}</code>s. Each term is assumed to associated with an identical list of EBRs.</p><p>To associate a set of coefficients to each term, see <a href="#SymmetricTightBinding.ParameterizedTightBindingModel"><code>ParameterizedTightBindingModel</code></a>, which also allows evaluation at specific momenta.</p><p><strong>Fields</strong></p><ul><li><code>terms :: Vector{TightBindingTerm{D}}</code>: a vector of <code>TightBindingTerm{D}</code>s, each of which represents a block (or conjugated pairs of blocks) of the Hamiltonian matrix.</li><li><code>cbr :: CompositeBandRep{D}</code>: the composite band representation associated to the model.</li><li><code>positions :: Vector{DirectPoint{D}}</code>: a vector of positions, specified in the lattice basis, associated to each orbital of the model.</li><li><code>N :: Int</code>: the total number of orbitals in the model, i.e., the size of the Hamiltonian matrix associated to each element of <code>terms</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/types.jl#L260-L278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.TightBindingModelMomentumGradient-Union{Tuple{C}, Tuple{D}, Tuple{Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, NTuple{C, Int64}}, Tuple{Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, NTuple{C, Int64}, NTuple{C, Matrix{ComplexF64}}}} where {D, C}" href="#SymmetricTightBinding.TightBindingModelMomentumGradient-Union{Tuple{C}, Tuple{D}, Tuple{Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, NTuple{C, Int64}}, Tuple{Union{NTuple{D, var&quot;#s38&quot;} where var&quot;#s38&quot;&lt;:Real, AbstractVector{&lt;:Real}}, NTuple{C, Int64}, NTuple{C, Matrix{ComplexF64}}}} where {D, C}"><code>SymmetricTightBinding.TightBindingModelMomentumGradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(∇ptbm::TightBindingModelMomentumGradient{D})(
    k::ReciprocalPointLike{D},
    components::NTuple{C, Int},
    [∇Hs::NTuple{C, Matrix{ComplexF64}}]
) --&gt; ∇Hs</code></pre><p>Evaluate components of the momentum gradient <code>∇ptbm</code> at momentum <code>k</code>, writing into the mutated matrix tuple <code>∇Hs</code> (automatically initialized if not provided). </p><p>The momentum components are specified by the <code>components</code> argument. These specifications are assumed relative to the primitive reciprocal lattice vectors <span>$\mathbf{b}_i$</span> (which <code>k = (k₁, k₂, k₃)</code> is also assumed specified relative to, such that the momentum vector is <span>$\mathbf{k} = k_1 \mathbf{b}_1 + k_2 \mathbf{b}_2 + k_3 \mathbf{b}_3$</span>). E.g., for a 3D model with <code>components = (2, 3)</code>, the elements of the returned <code>∇Hs</code> tuple have the interpretation that <code>∇Hs[1]</code> is the gradient of the Hamiltonian with respect to <code>k₂</code>, i.e., <span>$\partial H/\partial k_2$</span>, and <code>∇Hs[2]</code> is the gradient with respect to <code>k₃</code>, <span>$\partial H/\partial k_3$</span>.</p><p><strong>Coordinate transformation</strong></p><p>Note that because <code>k</code> is specified relative to the primitive reciprocal basis, which is generally neither orthogonal nor unit-normalized, the computed gradient is not the gradient with respect to the Cartesian components of <span>$\mathbf{k}$</span>, nor with respect to the coefficients of unit-normalized primitive reciprocal lattice vectors.</p><p>One may readily convert to either of these cases by using the chain rule, however. E.g., the gradient components <span>$\partial H/\partial k̃_i$</span> for coordinates <span>$k̃_i$</span> relative to a unit-normalized reciprocal basis specification of the momentum vector <span>$\mathbf{k} = k̃_1\hat{\mathbf{b}}_1 + k̃_2\hat{\mathbf{b}}_2 + k̃_3\hat{\mathbf{b}}_3$</span> are related to the returned components by <span>$\partial H/\partial k̃_i = |\mathbf{b}_i|^{-1} \partial H/\partial k_i$</span>.</p><p>Similarly, the components relative to Cartesian coordinates <span>$kᶜ_i$</span> of the momentum vector <span>$\mathbf{k} = kᶜ_1\hat{\mathbf{e}}_1 + kᶜ_2\hat{\mathbf{e}}_2 +  kᶜ_3\hat{\mathbf{e}}_3$</span> can be obtained via <span>$\partial H/\partial kᶜ_i = \sum_j (\mathbf{B}^{-\mathrm{T}})_{ij} \partial H/\partial k_j$</span>, where <span>$\mathbf{B} = [\mathbf{b}_1 \mathbf{b}_2 \mathbf{b}_3]$</span> is a matrix whose columns are the primitive reciprocal lattice vectors and <span>$\mathbf{B}^{-\mathrm{T}}$</span> is its inverse transpose.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/54783777b64f18128e14d916f28f459cb65e5025/src/gradients.jl#L127-L167">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../symmetry-breaking/">« Symmetry breaking</a><a class="docs-footer-nextpage" href="../internal-api/">Internal API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 20 October 2025 09:08">Monday 20 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
