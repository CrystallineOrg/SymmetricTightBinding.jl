<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internal API · SymmetricTightBinding.jl</title><meta name="title" content="Internal API · SymmetricTightBinding.jl"/><meta property="og:title" content="Internal API · SymmetricTightBinding.jl"/><meta property="twitter:title" content="Internal API · SymmetricTightBinding.jl"/><meta name="description" content="Documentation for SymmetricTightBinding.jl."/><meta property="og:description" content="Documentation for SymmetricTightBinding.jl."/><meta property="twitter:description" content="Documentation for SymmetricTightBinding.jl."/><meta property="og:url" content="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/internal-api/"/><meta property="twitter:url" content="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/internal-api/"/><link rel="canonical" href="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/internal-api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SymmetricTightBinding.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../api/">API</a></li><li class="is-active"><a class="tocitem" href>Internal API</a><ul class="internal"><li><a class="tocitem" href="#Unexported,-internal-functionality"><span>Unexported, internal functionality</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Internal API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internal API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/main/docs/src/internal-api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internal-API"><a class="docs-heading-anchor" href="#Internal-API">Internal API</a><a id="Internal-API-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-API" title="Permalink"></a></h1><p>This page lists unexported functionality from SymmetricTightBinding.jl that may be of interest to developers.</p><hr/><h2 id="Unexported,-internal-functionality"><a class="docs-heading-anchor" href="#Unexported,-internal-functionality">Unexported, internal functionality</a><a id="Unexported,-internal-functionality-1"></a><a class="docs-heading-anchor-permalink" href="#Unexported,-internal-functionality" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.OrbitalOrdering-Union{Tuple{Crystalline.NewBandRep{D}}, Tuple{D}} where D" href="#SymmetricTightBinding.OrbitalOrdering-Union{Tuple{Crystalline.NewBandRep{D}}, Tuple{D}} where D"><code>SymmetricTightBinding.OrbitalOrdering</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OrbitalOrdering(br::NewBandRep{D}) --&gt; OrbitalOrdering{D}</code></pre><p>Establishes a canonical, local ordering for the orbitals associated to a band representation <code>br</code>. This is the default ordering used when associating row/column indices in a tight-binding Hamiltonian block to specific orbitals in the associated band representations.</p><p>The canonical orbital ordering is stored in <code>.ordering</code>. The <code>i</code>th elements of <code>ordering</code>, <code>ordering[i]</code>, is a <code>NamedTuple</code> with two fields: <code>wp</code> and <code>idx</code>:</p><ul><li><code>wp</code>: stores a Wyckoff position in the orbit of the Wyckoff position associated to <code>br.wp</code>.</li><li><code>idx</code>: stores the index of the partner function of the site-symmetry irrep associated to <code>br</code> at <code>wp</code>.</li></ul><p>I.e., the <code>i</code>th orbital associated to <code>br</code> is located at <code>wp</code> and transforms as the <code>idx</code>th partner function of the site-symmetry irrep of <code>br.siteir</code>. The total number of orbitals associated to a band representation, and hence the length of <code>ordering</code>, is the product of the site-symmetry irrep dimensionality and the number of sites in the Wyckoff position orbit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L267-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.SiteInducedSGRepElement" href="#SymmetricTightBinding.SiteInducedSGRepElement"><code>SymmetricTightBinding.SiteInducedSGRepElement</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SiteInducedSGRepElement{D}(
    ρ::AbstractMatrix,
    positions::Vector{DirectPoint{D}},
    op::SymOperation{D}
)</code></pre><p>Represents a matrix-valued element of a site-induced representation of a space group, including a global momentum-dependent phase factor.</p><p>This structure behaves like a functor: calling it with a momentum <code>k :: AbstractVector</code>  returns the matrix representation at <code>k</code>.</p><p><strong>Fields (internal)</strong></p><ul><li><code>ρ :: Matrix{ComplexF64}</code> : The momentum-independent matrix part of the representation.</li><li><code>positions :: Vector{DirectPoint{D}}</code>: Real-space positions corresponding to the orbitals in the orbit of the associated site-symmetry group.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/site_representations.jl#L83-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding._maybe_add_hoppings!-Union{Tuple{D}, Tuple{Any, Any, Any, Any, Any, AbstractArray{Crystalline.SymOperation{D}, 1}}} where D" href="#SymmetricTightBinding._maybe_add_hoppings!-Union{Tuple{D}, Tuple{Any, Any, Any, Any, Any, AbstractArray{Crystalline.SymOperation{D}, 1}}} where D"><code>SymmetricTightBinding._maybe_add_hoppings!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Computes and adds the symmetry related partners of a hopping term <code>δ</code> to the <code>δ_orbit</code>.</p><div class="admonition is-warning" id="Warning-7550a07d84895c44"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-7550a07d84895c44" title="Permalink"></a></header><div class="admonition-body"><p>This function is an internal helper function for <code>maybe_add_hoppings!</code> and is not part of the public API.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L108-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding._permute_symmetry_related_hoppings_under_symmetry_operation-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.SymOperation{D}}} where D" href="#SymmetricTightBinding._permute_symmetry_related_hoppings_under_symmetry_operation-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.SymOperation{D}}} where D"><code>SymmetricTightBinding._permute_symmetry_related_hoppings_under_symmetry_operation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Build the P matrix for a particular symmetry operation acting on k-space, which permutes the rows of the M matrix.</p><p>For obtaining the P matrix, we make use that the action is on exponential of the type: <span>$𝐞xp(2πk⋅δ)$</span>, to instead act on δ ∈ <code>h_orbit.orbit</code> instead of k, which is a symbolic variable. Because of that, we need to use the inverse of the rotation part of the symmetry operation.</p><details class="admonition is-details" id="Sketch-of-proof-f99333f983d5d2b0"><summary class="admonition-header">Sketch of proof<a class="admonition-anchor" href="#Sketch-of-proof-f99333f983d5d2b0" title="Permalink"></a></summary><div class="admonition-body"><p>Assume g={R|τ} and <code>Crystalline</code> implements gk=(R⁻¹)ᵀk. Then (gk)⋅δ = ((R⁻¹)ᵀk)⋅δ + τ = k⋅(R⁻¹)δ.</p></div></details><div class="admonition is-info" id="Info-f210059ca2dcb131"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-f210059ca2dcb131" title="Permalink"></a></header><div class="admonition-body"><p>It is assumed that the operation <code>op</code> is provided in a primitive setting.</p></div></div><div class="admonition is-warning" id="Warning-38dbbb304cdd4cbe"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-38dbbb304cdd4cbe" title="Permalink"></a></header><div class="admonition-body"><p>This function is an internal helper function for <code>reciprocal_constraints_matrices</code> and is not part of the public API.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L668-L687">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding._poormans_sparsification-Tuple{AbstractMatrix{&lt;:Number}}" href="#SymmetricTightBinding._poormans_sparsification-Tuple{AbstractMatrix{&lt;:Number}}"><code>SymmetricTightBinding._poormans_sparsification</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Poor man&#39;s &quot;matrix sparsification&quot; via the reduced row echelon form.</p><div class="admonition is-warning" id="Warning-5371f01475fc5fc4"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-5371f01475fc5fc4" title="Permalink"></a></header><div class="admonition-body"><p>This function is an internal helper function for <code>obtain_basis_free_parameters</code> and is not part of the public API.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L711-L717">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding._prune_at_threshold!-Union{Tuple{AbstractVector{&lt;:AbstractVector{T}}}, Tuple{T}} where T&lt;:Complex" href="#SymmetricTightBinding._prune_at_threshold!-Union{Tuple{AbstractVector{&lt;:AbstractVector{T}}}, Tuple{T}} where T&lt;:Complex"><code>SymmetricTightBinding._prune_at_threshold!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Prune near-zero elements of vectors in <code>vs</code>.</p><div class="admonition is-warning" id="Warning-5371f01475fc5fc4"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-5371f01475fc5fc4" title="Permalink"></a></header><div class="admonition-body"><p>This function is an internal helper function for <code>obtain_basis_free_parameters</code> and is not part of the public API.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L732-L738">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.add_timereversal_related_orbits!-Union{Tuple{Array{HoppingOrbit{D}, 1}}, Tuple{D}} where D" href="#SymmetricTightBinding.add_timereversal_related_orbits!-Union{Tuple{Array{HoppingOrbit{D}, 1}}, Tuple{D}} where D"><code>SymmetricTightBinding.add_timereversal_related_orbits!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_timereversal_related_orbits!(h_orbits::Vector{HoppingOrbit{D}}) where {D}</code></pre><p>Adds the time-reversed hopping terms to the hopping orbits in <code>h_orbits</code>. The time-reversed hopping terms are added to the orbit of the hopping term they are related to, and if they are already present in another orbit, the two orbits are merged.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L173-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.construct_M_matrix-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}}} where D" href="#SymmetricTightBinding.construct_M_matrix-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}}} where D"><code>SymmetricTightBinding.construct_M_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">construct_M_matrix(
    h_orbit::HoppingOrbit{D}, br1::NewBandRep{D}, br2::NewBandRep{D},
    [ordering1, ordering2]) 
    --&gt; Array{Int,4}</code></pre><p>Construct a set of matrices that encodes a Hamiltonian&#39;s term which resembles the hopping from EBR <code>br1</code> to EBR <code>br2</code>.</p><p>The encoding is stored as a 4D matrix. Its last two axes correspond to elements of the Bloch Hamiltonian H(k); its first axis corresponds to <code>orbit(h_orbit)</code> and the associated complex exponentials stored in <code>v</code>; and its second axis to the elements of the vector <code>t</code>. That is:</p><pre><code class="nohighlight hljs">Hₛₜ(k) = vᵢ(k) Mᵢⱼₛₜ tⱼ</code></pre><p>See <code>devdocs.md</code> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L310-L327">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.evaluate_tight_binding_term!-Union{Tuple{D}, Tuple{SymmetricTightBinding.TightBindingTerm{D}, Union{NTuple{D, var&quot;#s40&quot;} where var&quot;#s40&quot;&lt;:Real, AbstractVector{&lt;:Real}}}, Tuple{SymmetricTightBinding.TightBindingTerm{D}, Union{NTuple{D, var&quot;#s40&quot;} where var&quot;#s40&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Union{Nothing, Number}}, Tuple{SymmetricTightBinding.TightBindingTerm{D}, Union{NTuple{D, var&quot;#s40&quot;} where var&quot;#s40&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Union{Nothing, Number}, Matrix{ComplexF64}}} where D" href="#SymmetricTightBinding.evaluate_tight_binding_term!-Union{Tuple{D}, Tuple{SymmetricTightBinding.TightBindingTerm{D}, Union{NTuple{D, var&quot;#s40&quot;} where var&quot;#s40&quot;&lt;:Real, AbstractVector{&lt;:Real}}}, Tuple{SymmetricTightBinding.TightBindingTerm{D}, Union{NTuple{D, var&quot;#s40&quot;} where var&quot;#s40&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Union{Nothing, Number}}, Tuple{SymmetricTightBinding.TightBindingTerm{D}, Union{NTuple{D, var&quot;#s40&quot;} where var&quot;#s40&quot;&lt;:Real, AbstractVector{&lt;:Real}}, Union{Nothing, Number}, Matrix{ComplexF64}}} where D"><code>SymmetricTightBinding.evaluate_tight_binding_term!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluate_tight_binding_term!(tbt::TightBindingTerm, k, [c, H])</code></pre><p>Evaluate the tight-binding term <code>tbt</code> at momentum <code>k</code>, possibly multiplied by a scalar coefficient <code>c</code> (unity if omitted). The term is <em>added</em> into the scratch space matrix <code>H</code>; if <code>H</code> is not provided, it is initialized as a zero matrix of the appropriate size.</p><p>The function returns the modified <code>H</code> matrix.</p><p><strong>Note</strong></p><p>The two-argument form of the function, i.e., returning the value of <code>tbt</code> at <code>k</code>, can be more simply achieved via <code>tbt(k)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/types.jl#L363-L375">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.inversion-Tuple{Val{3}}" href="#SymmetricTightBinding.inversion-Tuple{Val{3}}"><code>SymmetricTightBinding.inversion</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inversion(::Val{D}) --&gt; SymOperation{D}</code></pre><p>Return the inversion operation in dimension <code>D</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/utils.jl#L67-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.maybe_add_hoppings!-Union{Tuple{D}, Tuple{Any, Any, Any, Any, Any, AbstractArray{Crystalline.SymOperation{D}, 1}}} where D" href="#SymmetricTightBinding.maybe_add_hoppings!-Union{Tuple{D}, Tuple{Any, Any, Any, Any, Any, AbstractArray{Crystalline.SymOperation{D}, 1}}} where D"><code>SymmetricTightBinding.maybe_add_hoppings!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">maybe_add_hoppings!(h_orbits, δ, qₐ, qᵦ, R, ops) --&gt; Vector{HoppingOrbit{D}}</code></pre><p>Checks if a hopping term <code>δ</code> is already in the list of representatives. If not, it adds it and its symmetry related partners. If it is, it only adds the symmetry related partners.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L81-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.obtain_basis_free_parameters-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}}} where D" href="#SymmetricTightBinding.obtain_basis_free_parameters-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}}} where D"><code>SymmetricTightBinding.obtain_basis_free_parameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obtain_basis_free_parameters(
    h_orbit::HoppingOrbit{D},
    brₐ::NewBandRep{D}, 
    brᵦ::NewBandRep{D}, 
    [orderingₐ = OrbitalOrdering(brₐ), orderingᵦ = OrbitalOrdering(brᵦ)]
    )                            --&gt; Tuple{Array{Int,4}, Vector{Vector{ComplexF64}}}</code></pre><p>Obtain the basis of free parameters for the hopping terms between <code>brₐ</code> and <code>brᵦ</code>  associated with the hopping orbit <code>h_orbit</code>.</p><p><strong>Note</strong></p><p>The presence or absence of time-reversal symmetry is inferred implicitly from <code>brₐ</code> and <code>brᵦ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L415-L429">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.obtain_basis_free_parameters_TRS-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}, AbstractArray{Int64, 4}}} where D" href="#SymmetricTightBinding.obtain_basis_free_parameters_TRS-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}, AbstractArray{Int64, 4}}} where D"><code>SymmetricTightBinding.obtain_basis_free_parameters_TRS</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obtain_basis_free_parameters_TRS(
    h_orbit::HoppingOrbit{D}, 
    brₐ::NewBandRep{D}, 
    brᵦ::NewBandRep{D}, 
    orderingₐ::OrbitalOrdering{D} = OrbitalOrdering(brₐ),
    orderingᵦ::OrbitalOrdering{D} = OrbitalOrdering(brᵦ),
    Mm::AbstractArray{4, Int} = construct_M_matrix(h_orbit, brₐ, brᵦ, orderingₐ, orderingᵦ)
    )                             --&gt; Tuple{Array{Int,4}, Vector{Vector{ComplexF64}}}}</code></pre><p>Obtain the basis of free parameters for the hopping terms between <code>brₐ</code> and <code>brᵦ</code> associated with the hopping orbit <code>h_orbit</code> under time-reversal symmetry.</p><p>Real and imaginary parts of the basis vectors are differentiated explicitly: internally, we consider only variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/timereversal.jl#L47-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.obtain_basis_free_parameters_hermiticity-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}, AbstractArray{Int64, 4}}} where D" href="#SymmetricTightBinding.obtain_basis_free_parameters_hermiticity-Union{Tuple{D}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}}, Tuple{HoppingOrbit{D}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, SymmetricTightBinding.OrbitalOrdering{D}, SymmetricTightBinding.OrbitalOrdering{D}, AbstractArray{Int64, 4}}} where D"><code>SymmetricTightBinding.obtain_basis_free_parameters_hermiticity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obtain_basis_free_parameters_hermiticity(
    h_orbit::HoppingOrbit{D},
    brₐ::NewBandRep{D},
    brᵦ::NewBandRep{D},
    orderingₐ::OrbitalOrdering{D} = OrbitalOrdering(brₐ),
    orderingᵦ::OrbitalOrdering{D} = OrbitalOrdering(brᵦ),
    Mm::AbstractArray{Int, 4} = construct_M_matrix(h_orbit, brₐ, brᵦ, orderingₐ, orderingᵦ);
    antihermitian::Bool = false,
) where {D}</code></pre><p>Constructs a basis for the coefficient vectors <code>t⁽ⁿ⁾</code> that span the space of Hermitian (or <code>antihermitian</code> if <code>true</code>) TB Hamiltonians <code>Hₛₜ(k) = vᵢ(k) Mᵢⱼₛₜ tⱼ = vᵀ(k) M⁽ˢᵗ⁾ t</code>. We do this by assuming that each coefficient vector <code>t</code> is sorted into a vector of the form <code>[tᴿ; itᴵ]</code> so that we can take the complex conjugate by as <code>t* = σ₃t</code>, which can then be moved onto <code>M⁽ˢᵗ⁾</code> instead of <code>t</code>. The constraint <code>Hₛₜ(k) = (H†)ₛₜ(k) = Hₜₛ*(k)</code> can then be expressed as <code>vᵀ(k) M⁽ˢᵗ⁾ tⱼ = v*ᵀ(k) M⁽ᵗˢ⁾ σ₃ t = vᵀ(k) (Pᵀ M⁽ᵗˢ⁾σ₃) t</code>, which requires that <code>t</code> be a solution to the nullspace <code>M⁽ˢᵗ⁾ - Pᵀ M⁽ᵗˢ⁾ σ₃ = 0</code>. We cast this as <code>Z - Q = 0</code>, with <code>Z = M⁽ˢᵗ⁾</code> and <code>Q = Pᵀ M⁽ᵗˢ⁾ σ₃</code>.</p><p><strong>Notes</strong></p><p>For anti-Hermitian symmetry, we require <code>Hₛₜ(k) = -Hₜₛ*(k)</code>, which translates to <code>M⁽ˢᵗ⁾ + Pᵀ M⁽ᵗˢ⁾ σ₃ = 0</code>; i.e., simply swaps the sign of <code>Q</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/hermiticity.jl#L2-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.pin_free-Union{Tuple{D}, Tuple{Crystalline.NewBandRep{D}, AbstractVector{&lt;:Real}}} where D" href="#SymmetricTightBinding.pin_free-Union{Tuple{D}, Tuple{Crystalline.NewBandRep{D}, AbstractVector{&lt;:Real}}} where D"><code>SymmetricTightBinding.pin_free</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pin_free(br::NewBandRep{D}, αβγ::AbstractVector{&lt;:Real}) where D</code></pre><p>Pin the free parameters of the Wyckoff position associated with the band representation <code>br</code> to the values in <code>αβγ</code>. </p><p>Returns a new band representation with all other properties, apart from the Wyckoff position, identical to (and sharing memory with) <code>br</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/utils.jl#L201-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.primitivized_orbit-Union{Tuple{Crystalline.NewBandRep{D}}, Tuple{D}} where D" href="#SymmetricTightBinding.primitivized_orbit-Union{Tuple{Crystalline.NewBandRep{D}}, Tuple{D}} where D"><code>SymmetricTightBinding.primitivized_orbit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">primitivized_orbit(br::NewBandRep{D}) where D</code></pre><p>Return the orbit of the Wyckoff position associated with the band representation <code>br</code>. The coordinates of positions in the orbit are given relative to the primitive unit cell.</p><p>Positions are returned as a <code>Vector{DirectPoint{D}}</code>.</p><p>The following checks are made, producing an error if violated:</p><ol><li>There are no free parameters associated with the Wyckoff position.</li><li>For every position, its coordinates, referred to the primitive basis, is in the range [0,1); i.e., every position lies in the parallepiped primitive unit cell [0,1)ᴰ.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/utils.jl#L127-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.reciprocal_constraints_matrices-Union{Tuple{D}, Tuple{AbstractArray{Int64, 4}, AbstractArray{Crystalline.SymOperation{D}, 1}, HoppingOrbit{D}}} where D" href="#SymmetricTightBinding.reciprocal_constraints_matrices-Union{Tuple{D}, Tuple{AbstractArray{Int64, 4}, AbstractArray{Crystalline.SymOperation{D}, 1}, HoppingOrbit{D}}} where D"><code>SymmetricTightBinding.reciprocal_constraints_matrices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reciprocal_constraints_matrices(
                                Mm::AbstractArray{Int,4}, 
                                gens::AbstractVector{SymOperation{D}}, 
                                h_orbit::HoppingOrbit{D}
                                ) --&gt; Vector{Array{Int,4}}</code></pre><p>Compute the reciprocal constraints matrices for the generators of the SG. This is done by permuting the rows of the M matrix according to the symmetry operation acting on k-space. See more details in <code>permute_symmetry_related_hoppings_under_symmetry_operation</code> and <code>devdocs.md</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L635-L646">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.reciprocal_constraints_trs-Union{Tuple{D}, Tuple{AbstractArray{Int64, 4}, HoppingOrbit{D}}} where D" href="#SymmetricTightBinding.reciprocal_constraints_trs-Union{Tuple{D}, Tuple{AbstractArray{Int64, 4}, HoppingOrbit{D}}} where D"><code>SymmetricTightBinding.reciprocal_constraints_trs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reciprocal_constraints_trs(Mm::AbstractArray{Int,4}, h_orbit::HoppingOrbit{D}) 
--&gt; Array{ComplexF64,4}</code></pre><p>Time reversal symmetry action on reciprocal space. It is given by the association  <code>k -&gt; -k =&gt; H(k) -&gt; H(-k)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/timereversal.jl#L97-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.representation_constraint_matrices-Union{Tuple{D}, Tuple{AbstractArray{Int64, 4}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, AbstractArray{Crystalline.SymOperation{D}, 1}}} where D" href="#SymmetricTightBinding.representation_constraint_matrices-Union{Tuple{D}, Tuple{AbstractArray{Int64, 4}, Crystalline.NewBandRep{D}, Crystalline.NewBandRep{D}, AbstractArray{Crystalline.SymOperation{D}, 1}}} where D"><code>SymmetricTightBinding.representation_constraint_matrices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">representation_constraints_matrices(
    Mm::AbstractArray{Int,4}, 
    brₐ::NewBandRep{D},
    brᵦ::NewBandRep{D}) --&gt; Vector{Array{ComplexF64,4}}</code></pre><p>Build the Q matrix for a particular symmetry operation (or, equivalently, a particular matrix from the site-symmetry representation), acting on the M matrix. Relative to our white-board notes, Q has swapped indices, in the sense we below give <code>Q[i,j,r,l]</code>.</p><p>(ρₐₐ)ᵣₛ Hₛₜ (ρᵦᵦ⁻¹)ₜₗ = (ρₐₐ)ᵣₛ vᵢ Mᵢⱼₛₜ tⱼ (ρᵦᵦ⁻¹)ₜₗ = vᵢ (ρₐₐ)ᵣₛ Mᵢⱼₛₜ (ρᵦᵦ⁻¹)ₜₗ tⱼ,</p><p>then we can define: Qᵢⱼᵣₗ = (ρₐₐ)ᵣₛ Mᵢⱼₛₜ (ρᵦᵦ⁻¹)ₜₗ</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/tightbinding.jl#L374-L387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.representation_constraint_trs-Union{Tuple{D}, Tuple{AbstractArray{&lt;:Number, 4}, HoppingOrbit{D}}} where D" href="#SymmetricTightBinding.representation_constraint_trs-Union{Tuple{D}, Tuple{AbstractArray{&lt;:Number, 4}, HoppingOrbit{D}}} where D"><code>SymmetricTightBinding.representation_constraint_trs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">representation_constraint_trs(Mm::AbstractArray{Int,4}, h_orbit::HoppingOrbit{D})
--&gt; Array{ComplexF64,4}</code></pre><p>Time reversal symmetry action on the Hamiltonian. It is given by the association δ -&gt; -δ and  the complex conjugation in the free-parameter part: <span>$tⱼ -&gt; tⱼ* ⇒ [tⱼᴿ, itⱼᴵ] -&gt; [tⱼᴿ, -itⱼᴵ] ⇒ H(k) -&gt; H*(k)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/timereversal.jl#L120-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.sgrep_induced_by_siteir_excl_phase-Union{Tuple{D}, Tuple{Crystalline.NewBandRep{D}, Crystalline.SymOperation{D}}} where D" href="#SymmetricTightBinding.sgrep_induced_by_siteir_excl_phase-Union{Tuple{D}, Tuple{Crystalline.NewBandRep{D}, Crystalline.SymOperation{D}}} where D"><code>SymmetricTightBinding.sgrep_induced_by_siteir_excl_phase</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sgrep_induced_by_siteir_excl_phase(br::NewBandRep, op::SymOperation)
sgrep_induced_by_siteir_excl_phase(cbr::CompositeBandRep, op::SymOperation)
    --&gt; Matrix{ComplexF64}</code></pre><p>Return the representation matrix of a symmetry operation <code>op</code> induced by the site symmetry group of a band representation <code>br</code> or composite band representation <code>cbr</code>, excluding the global momentum-dependent phase factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/site_representations.jl#L2-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.split_complex-Tuple{AbstractVector{&lt;:Number}}" href="#SymmetricTightBinding.split_complex-Tuple{AbstractVector{&lt;:Number}}"><code>SymmetricTightBinding.split_complex</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_complex(t::Vector{&lt;:Number}) -&gt; Matrix{Real}</code></pre><p>Consider <code>αt</code> where <code>α ∈ ℂ</code> and <code>t ∈ ℂⁿ</code> and build from <code>t</code> a matrix representation <code>T</code> that allows access to the real and imaginary parts of the product <code>αt</code> without using complex numbers by splitting α into a real 2-vector of its real and imaginary parts.</p><p>In particular, let <span>$α = αᴿ + iαᴵ$</span> and <span>$t = tᴿ + itᴵ$</span> with <code>αᴿ, αᴵ ∈ ℝ</code> and <span>$tᴿ, tᴵ ∈ ℝⁿ$</span>, then <span>$αt$</span> can be rewritten as</p><p class="math-container">\[αt = (αᴿ + iαᴵ)(tᴿ + itᴵ)
   = (αᴿtᴿ - αᴵtᴵ) + i(αᴿtᴵ + αᴵtᴿ)
   = [tᴿ, tᴵ]ᵀ [αᴿ, αᴵ] + i [tᴵ, tᴿ]ᵀ [αᴿ, αᴵ]\]</p><p>Then, defining <code>T = [tᴿ -tᴵ; tᴵ tᴿ]</code>, the above product can then be reexpressed as: <span>$Re(αt) = αᴿtᴿ - αᴵtᴵ =$</span> <code>(T * [αᴿ; αᴵ])[1:n]</code> and <span>$Im(αt) = αᴿtᴵ + αᴵtᴿ =$</span> <code>(T * [αᴿ; αᴵ])[n+1:2n]</code>. I.e., the &quot;upper half&quot; of the product <code>T * [real(α), imag(α)]</code> is <code>real(α * t)</code> and the  &quot;lower half&quot; is <code>imag(αt)</code>.</p><p>This functionality is used to avoid complex numbers in amplitude basis coefficients, which simplifies the application of time-reversal symmetry and hermiticity.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; using SymmetricTightBinding: split_complex

julia&gt; t = [im,0]
2-element Vector{Complex{Int64}}:
 0 + 1im
 0 + 0im

julia&gt; T = split_complex(t)
4×2 Matrix{Int64}:
 0  -1
 0   0
 1   0
 0   0

julia&gt; α = 0.5+0.2im; αv = [real(α), imag(α)];

julia&gt; (T * αv)[1:2] == real(α*t) &amp;&amp; (T * αv)[3:4] == imag(α*t)</code></pre><pre><code class="language-julia hljs">julia&gt; t = [1,im]
2-element Vector{Complex{Int64}}:
 1 + 0im
 0 + 1im

julia&gt; split_complex(t)
4×2 Matrix{Int64}:
 1   0
 0  -1
 0   1
 1   0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/utils.jl#L1-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SymmetricTightBinding.zassenhaus_intersection-Union{Tuple{T}, Tuple{AbstractArray{T}, AbstractArray{T}}, Tuple{AbstractArray{T}, AbstractArray{T}, Real}} where T&lt;:Number" href="#SymmetricTightBinding.zassenhaus_intersection-Union{Tuple{T}, Tuple{AbstractArray{T}, AbstractArray{T}}, Tuple{AbstractArray{T}, AbstractArray{T}, Real}} where T&lt;:Number"><code>SymmetricTightBinding.zassenhaus_intersection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zassenhaus_intersection(U::AbstractArray{&lt;:Number}, W::AbstractArray{&lt;:Number}) 
    --&gt; AbstractArray{&lt;:Number}</code></pre><p>Finds the intersection of two bases <code>U</code> and <code>W</code> using the Zassenhaus algorithm. It assumes that the basis are given by columns.</p><p><strong>References</strong></p><ul><li>https://en.wikipedia.org/wiki/Zassenhaus_algorithm</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/4fa697df1696b9ba9415140527bcb8ac3e4ab0e7/src/zassenhaus.jl#L8-L17">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/">« API</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.0 on <span class="colophon-date" title="Wednesday 9 July 2025 14:03">Wednesday 9 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
