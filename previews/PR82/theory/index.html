<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory Â· SymmetricTightBinding.jl</title><meta name="title" content="Theory Â· SymmetricTightBinding.jl"/><meta property="og:title" content="Theory Â· SymmetricTightBinding.jl"/><meta property="twitter:title" content="Theory Â· SymmetricTightBinding.jl"/><meta name="description" content="Documentation for SymmetricTightBinding.jl."/><meta property="og:description" content="Documentation for SymmetricTightBinding.jl."/><meta property="twitter:description" content="Documentation for SymmetricTightBinding.jl."/><meta property="og:url" content="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/theory/"/><meta property="twitter:url" content="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/theory/"/><link rel="canonical" href="https://CrystallineOrg.github.io/SymmetricTightBinding.jl/theory/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SymmetricTightBinding.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Theory</a><ul class="internal"><li><a class="tocitem" href="#Table-of-contents"><span>Table of contents</span></a></li><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Transformation-properties-of-orbitals"><span>Transformation properties of orbitals</span></a></li><li><a class="tocitem" href="#Build-a-tight-binding-Hamiltonian-from-a-set-of-symmetric-orbitals"><span>Build a tight-binding Hamiltonian from a set of symmetric orbitals</span></a></li><li><a class="tocitem" href="#Appendix-A"><span>Appendix A</span></a></li></ul></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../band-symmetry/">Band symmetry</a></li><li><a class="tocitem" href="../symmetry-breaking/">Symmetry breaking</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../internal-api/">Internal API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theory</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CrystallineOrg/SymmetricTightBinding.jl/blob/main/docs/src/theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Theory-Notes"><a class="docs-heading-anchor" href="#Theory-Notes">Theory Notes</a><a id="Theory-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Theory-Notes" title="Permalink"></a></h1><p>This package heavily relays on <a href="https://en.wikipedia.org/wiki/Representation_theory_of_finite_groups">representation theory of groups</a> and in <a href="https://en.wikipedia.org/wiki/Electronic_band_structure">band theory</a> of crystals. Almost all this theory was introduced before, and, can be found in <a href="https://academic.oup.com/book/54787">Bradley &amp; Cracknell</a> and, later, developed by <a href="https://www.nature.com/articles/nature23268">Bradlyn <em>et al.</em></a>. Here, we aim to make a practical introduction to the main concepts and deduce the essential functions and relations that we needed for the implementation of this package. Additionally, we generalize some of the results previously derived and make them more accessible to the general public.</p><h2 id="Table-of-contents"><a class="docs-heading-anchor" href="#Table-of-contents">Table of contents</a><a id="Table-of-contents-1"></a><a class="docs-heading-anchor-permalink" href="#Table-of-contents" title="Permalink"></a></h2><ul><li><a href="#theory-notes">Theory Notes</a><ul><li><a href="#table-of-contents">Table of contents</a></li><li><a href="#introduction">Introduction</a></li><li><a href="#transformation-properties-of-orbitals">Transformation properties of orbitals</a><ul><li><a href="#transformation-properties-of-induced-bloch-functions">Transformation properties of induced Bloch functions</a></li></ul></li><li><a href="#build-a-tight-binding-hamiltonian-from-a-set-of-symmetric-orbitals">Build a tight-binding Hamiltonian from a set of symmetric orbitals</a><ul><li><a href="#transformation-properties-of-the-bloch-states">Transformation properties of the Bloch states</a><ul><li><a href="#transformation-properties-under-lattice-translations">Transformation properties under lattice translations</a></li><li><a href="#transformation-properties-under-symmetry-operations">Transformation properties under symmetry operations</a></li></ul></li></ul></li><li><a href="#appendix-a">Appendix A</a><ul><li><a href="#transformation-properties-within-convention-2">Transformation properties within Convention 2</a></li><li><a href="#bloch-hamiltonian-under-convention-2">Bloch Hamiltonian under Convention 2</a><ul><li><a href="#bloch-states-under-convention-2">Bloch states under Convention 2</a><ul><li><a href="#transformation-under-lattice-translations">Transformation under lattice translations</a></li><li><a href="#transformation-properties-under-symmetry-operations-1">Transformation properties under symmetry operations</a></li></ul></li></ul></li><li><a href="#conversions-between-convention-1-and-2">Conversions between Convention 1 and 2</a></li></ul></li></ul></li></ul><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>The introduction of <a href="https://academic.oup.com/book/54787">Topological Quantum Chemistry</a> (TQC) made a link between trivial insulators and atomic limits. It states that if a set of isolated bands can be described by a set of isolated â€” atomic-like â€” orbitals, the set must be topologically trivial. This link is determined by, first, analyzing all band symmetries of this &quot;atomic-like&quot; orbitals. Then, the band&#39;s set under study will be non-trivial if it doesn&#39;t fit in that list.</p><p>The analysis of the band symmetries of the isolated orbitals can be performed by placing localized, symmetric orbitals at some high-symmetry points <span>$ğª_Î±$</span> â€” <a href="https://en.wikipedia.org/wiki/Wyckoff_positions">Wyckoff position</a> â€” with some internal symmetry â€” corresponding to a particular site-symmetry irrep <span>$Ï$</span>. Those orbitals can be labeled as <span>$Ï•_{Î±i}(ğ«)$</span>, where <span>$i$</span> runs in the dimension of the irrep <span>$Ï$</span>, or just by <span>$(ğª_Î±|Ï)$</span>. By applying the Fourier transform, the induced Bloch functions can be obtain as:</p><p class="math-container">\[Ï†_{Î±i,ğ¤}(ğ«) = \sum_ğ­ e^{iğ¤Â·ğ­} Ï•_{Î±i}(ğ«-ğ­)\]</p><p>How <span>$Ï†_{Î±iğ¤}(ğ«)$</span> transform under symmetries will define a <a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.23.2824">band representation</a>.</p><p>The idea behind this package is to use these orbitals to build a tight-binding model that respect the symmetries and topology of the (trivial) set of bands whose band representation is matched by such set of orbitals.</p><p>To do so, it is necessary to access all possible types of symmetry-independent orbitals and high-symmetry points in every space group. Luckily, this was tabulated by <a href="https://academic.oup.com/book/54787">Bradley &amp; Cracknell</a> and implemented in the Julia package <a href="https://github.com/thchr/Crystalline.jl">Crystalline.jl</a>. This package is going to depend on the former package to access that information.</p><p>Now that the basic framework has been stablish, in the following sections, we are going to deduce how those functions will transform and how they can be used to build a symmetric tight-binding model.</p><h2 id="Transformation-properties-of-orbitals"><a class="docs-heading-anchor" href="#Transformation-properties-of-orbitals">Transformation properties of orbitals</a><a id="Transformation-properties-of-orbitals-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-properties-of-orbitals" title="Permalink"></a></h2><p>Let us assume we have identified a set of orbitals that describe the band structure of a trivial set of bands. This can be achieved through a TQC analysis of the bands, and several tools exist to perform such decomposition. For example, the package <a href="https://github.com/AntonioMoralesPerez/PhotonicTightBinding.jl">PhotonicTightBinding.jl</a> provides this functionality for photonic bands.</p><blockquote><p>[!NOTE] For instance, Graphene&#39;s two <em>p</em>&lt;sub&gt;<em>z</em>&lt;/sub&gt; orbitals sit at the 2b Wyckoff position. Although these orbitals are odd (i.e., changing sign) under mirror in the out-of-plane direction, they are even (i.e., invariant) under all in-plane symmetries, including rotations and mirrors. The corresponding site-symmetry irrep is the Aâ‚ irrep of the 2b Wyckoff position. Thus, these orbitals can be expressed as (2b|Aâ‚). However, take into account that not all band representations can be induced from a set of atomic (electronic) orbitals. Some might correspond to a hybridization or a complex mixture of them.</p></blockquote><p>Let us denote by <span>$Î±$</span> as the site in the Wyckoff position where the orbital is located, and <span>$i$</span> labels the number of orbitals associated to that site. Then, the orbital <span>$i$</span> at site <span>$Î±$</span> can be denoted as <span>$Ï•_I(ğ«)$</span>, where we introduce the compound index <span>$I=(Î±, i)$</span>. The complete set of orbitals that will be needed to describe the system is obtained by considering all orbitals at all sites and all lattice translations of them, i.e., <span>$\{Ï•_I(ğ«-ğ­)\}_{Iğ­}$</span>, where <span>$ğ­$</span> is a lattice translation vector.</p><p>We are going to focus on a particular site <span>$ğª_1$</span>, whose orbitals <span>$Ï•_{1i}(ğ«)$</span> will transform under a particular site-symmetry representation <span>$Ï$</span> of the site-symmetry group <span>$G_{ğª_1}$</span>. Then, for <span>$h âˆˆ G_{ğª_1}$</span>, this function will transform as:</p><p class="math-container">\[h Ï•_{1i}(ğ«) = [Ï(h)]_{ji} Ï•_{1j}(ğ«)\]</p><p>Since the orbitals are localized at a Wyckoff position, there exist a coset decomposition of the space group <span>$G$</span> that relates each site in the Wyckoff position, i.e., <span>$ğª_Î± = g_Î± ğª_1$</span> with <span>$g_Î± âˆˆ G$</span>.</p><blockquote><p>[!NOTE] The set of <span>$\{g_Î±\}$</span>, in combination with translations <span>$T$</span>, will generate a decomposition of <span>$G$</span> with respect to <span>$G_ğª$</span>:</p><p class="math-container">\[G = \bigcup_Î± g_Î± (G_{ğª_1} \ltimes T)\]</p></blockquote><p>Thus, each function in the unit cell can be built from the ones at site <span>$ğª_1$</span> as follows:</p><p class="math-container">\[Ï•_{Î±i}(ğ«) = g_Î± Ï•_{1i}(ğ«) = Ï•_{1i}(g_Î±^{-1} ğ«)\]</p><p>By extension, translated counterparts can be defined by:</p><p class="math-container">\[\{E|ğ­\} Ï•_I(ğ«) = Ï•_I(ğ«-ğ­)\]</p><p>The aforementioned coset decomposition also have an interesting implication: for any operation <span>$g = \{R|ğ¯\} âˆˆ G$</span>, there is an unique choice of <span>$Î²$</span> for each <span>$Î±$</span> such that <span>$g g_Î± = \{E|ğ­_{Î²Î±}\} g_Î² h$</span>, for some <span>$h âˆˆ G_{ğª_1}$</span> and <span>$ğ­_{Î²Î±} = g ğª_Î± - ğª_Î²$</span>. The formal proof of this statement is out of the scope of this notes and can be found in this <a href="https://www.nature.com/articles/nature23268">article</a>. An intuitive picture of this statement is represented by the following figure:</p><p><img src="../figures/coset_decomposition.png" alt="Coset decomposition"/></p><p>Taking into consideration the definitions of the transformed orbitals and the previous decomposition, we deduce that the orbitals transform under the induced representation <span>$Ï_G$</span> according to:</p><p class="math-container">\[Ï_G(g) Ï•_{Î±i}(ğ«-ğ­) = g \{E|ğ­\} Ï•_{Î±i}(ğ«) \\
= \{E|Rğ­\} g Ï•_{Î±i}(ğ«) \\
= \{E|Rğ­\} \{E|ğ­_{Î²Î±}\} g_Î² h g_Î±^{-1} Ï•_{Î±i}(ğ«) \\
= \{E|Rğ­ + ğ­_{Î²Î±}\} g_Î² h Ï•_{1i}(ğ«) \\
= \sum_j \{E|Rğ­ + ğ­_{Î²Î±}\} g_Î² [Ï(h)]_{ji} Ï•_{1j}(ğ«) \\
= \sum_j [Ï(h)]_{ji} \{E|Rğ­ + ğ­_{Î²Î±}\} Ï•_{Î²j}(ğ«) \\
= \sum_j [Ï(h)]_{ji} Ï•_{Î²j}(ğ« - Rğ­ - ğ­_{Î²Î±})\]</p><p>In principle, we could use the complete set of orbitals â€” <span>$\{Ï•_I(ğ«-ğ­)\}$</span>, with all degrees of freedom <span>$I$</span> and all lattice translations <span>$ğ­$</span> â€” to build a tight-binding model. However, it is more practical (and usual) to use the translational invariance of this orbitals to define a Fourier transform, and use their Fourier transformed functions as a basis â€” we are going to label such functions as induced Bloch functions. By doing so, instead of working with <span>$\dim(I) \times N$</span> orbitals, where <span>$\dim(I)$</span> is the number of sites plus the number of orbitals at each site and <span>$N$</span> is the number of unit cells; you can consider <span>$\dim(I)$</span> functions evaluated at <span>$N$</span> points inside the Brillouin zone.</p><p>However, when defining a Fourier transform, there is a gauge freedom which leads to different, so-called, &quot;conventions&quot;. This choice has important implications on the representations of the symmetry operations and, even, in the representation of the Hamiltonian. Here, we are going to focus on one convention, and we are going to discuss changes and similarities with another convention in <a href="#appendix-a">Appendix A</a>.</p><h3 id="Transformation-properties-of-induced-Bloch-functions"><a class="docs-heading-anchor" href="#Transformation-properties-of-induced-Bloch-functions">Transformation properties of induced Bloch functions</a><a id="Transformation-properties-of-induced-Bloch-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-properties-of-induced-Bloch-functions" title="Permalink"></a></h3><p>Using the translational invariance of the orbitals, we can formally define a Fourier transform of them. This functions will not be solution to any SchrÃ¶dinger-like problem, so instead of calling them Bloch states we pick up the term of <em>induced</em> Bloch functions, or just Bloch functions.</p><p>As mentioned before, there is a gauge freedom on the choice of the Fourier transform. Here, we are going to choose the following one:</p><p class="math-container">\[Ï†_{I,ğ¤}(ğ«) â‰¡ \sum_ğ­ e^{iğ¤Â·(ğ­+ğª_Î±)} Ï•_I(ğ«-ğ­)\]</p><p>The main reason behind this choice is due to fact that, with this gauge choice, the ğ¤-space dependence of the space group transformations&#39; representations enters as a global phase, as we will see. This is really convenient for computation purposes and that is why we picked it. However, this convention enforced that the Bloch functions are not periodic in reciprocal space:</p><p class="math-container">\[Ï†_{I,ğ¤+ğ†} = \sum_ğ­ e^{i(ğ¤+ğ†)Â·(ğ­+ğª_Î±)} Ï•_I(ğ«-ğ­) \\
= \sum_ğ­ e^{iğ†Â·(ğ­+ğª_Î±)} e^{iğ¤Â·(ğ­+ğª_Î±)} Ï•_I(ğ«-ğ­) \\
= e^{iğ†Â·ğª_Î±} Ï†_{I,ğ¤}\]</p><p>This implies that if the orbital is located at a non-integer position in the unit-cell, i.e, located at positions that are integer combinations of lattice vectors, the phase factor will differ from unity and the Bloch function will gain a phase. This yields that, in general, Bloch functions are not periodic under reciprocal lattice translations within this convention. This has interesting implications in the computation of some parts of this package, such as, the representation of symmetry operations or symmetry eigenvalues.</p><p>Since this functions are derived from the orbitals, the transformations properties of this functions can be obtained. How this functions transform under symmetry operations will conform what is usually called a <em>band representation</em>. In particular, this band representation will be:</p><p class="math-container">\[g Ï†_{iÎ±,ğ¤}(ğ«) = \frac{1}{\sqrt{N}} \sum_ğ­ e^{iğ¤Â·(ğ­+ğª_Î±)} g Ï•_{iÎ±}(ğ«-ğ­) \\
= \frac{1}{\sqrt{N}} \sum_{ğ­,j} e^{iğ¤Â·(ğ­+ğª_Î±)} [Ï(h)]_{ji} Ï•_{jÎ²}(ğ«-Rğ­-ğ­_{Î²Î±}) \\
= \frac{1}{\sqrt{N}} \sum_{ğ­&#39;,j} [Ï(h)]_{ji} e^{iğ¤Â·R^{-1}(ğ­&#39;+ğª_Î²-ğ¯)} Ï•_{jÎ²}(ğ«-ğ­&#39;) \\
= e^{-i([R^{-1}]^T ğ¤)Â·ğ¯} \frac{1}{\sqrt{N}} \sum_{ğ­&#39;,j} [Ï(h)]_{ji} e^{i([R^{-1}]^T ğ¤)Â·(ğ­&#39;+ğª_Î²)} Ï•_{jÎ²}(ğ«-ğ­&#39;) \\
= e^{-i([R^{-1}]^T ğ¤)Â·ğ¯} \sum_j [Ï(h)]_{ji} Ï†_{jÎ²,[R^{-1}]^T ğ¤}(ğ«),\]</p><p>where we have defined <span>$ğ­&#39; = Rğ­ + ğ­_{Î²Î±} â‡’ ğ­ = R^{-1} (ğ­&#39;-ğ­_{Î²Î±})$</span>, and we have used the following property: <span>$ğ¤Â·(R ğ«) = (R^T ğ¤)Â·ğ«$</span>. Finally, if the define the action of a symmetry operation <span>$g = \{R|ğ¯\}$</span> on a reciprocal space vector ğ¤ as: <span>$gğ¤ â‰¡ [R^{-1}]^T ğ¤$</span>, we can rewrite the previous relation as:</p><p class="math-container">\[g Ï†_{I,ğ¤}(ğ«) = e^{-i(g ğ¤)Â·ğ¯} \sum_J [Ï(h)]_{JI} Ï†_{J,g ğ¤}(ğ«)\]</p><p>This relation will be crucial in the implementation of the package, since it states the band representation of the system. If a tight-binding model is built from this set of functions, its band structure will, by construction, replicate the one of the original system. In other words, the tight-binding model will inherit all symmetries of the system, forcing the same degeneracies the system has, and exhibit the same symmetry-indicated topology.</p><p>For the sake of simplicity, we are going to define a matrix <span>$D_ğ¤(g)$</span>, whose entries will be conformed by the previous operation, i.e., <span>$[D_ğ¤(g)]_{JI} = e^{-i(g ğ¤)Â·ğ¯} [Ï(h)]_{JI}$</span>, where remember that: <span>$I = (Î±,i)$</span>, <span>$J = (Î²,j)$</span> and <span>$ğ­_{Î²Î±} = g ğª_Î± - ğª_Î²$</span>. Then, we can rewrite the previous relation as:</p><p class="math-container">\[\boxed{g Ï†_{I,ğ¤}(ğ«) = \sum_J [D_ğ¤(g)]_{JI} Ï†_{J,g ğ¤}(ğ«)}\]</p><p>It is important to notice that the dependence on ğ¤ of the representation <span>$D_ğ¤$</span> is a global phase factor. This is really convenient for computational purposes when imposing the symmetry constraints in the Hamiltonian.</p><p>Then, our next objective is to build a tight-binding model that uses this functions as basis and replicates the band structure of the system. We perform this construction in the next section.</p><h2 id="Build-a-tight-binding-Hamiltonian-from-a-set-of-symmetric-orbitals"><a class="docs-heading-anchor" href="#Build-a-tight-binding-Hamiltonian-from-a-set-of-symmetric-orbitals">Build a tight-binding Hamiltonian from a set of symmetric orbitals</a><a id="Build-a-tight-binding-Hamiltonian-from-a-set-of-symmetric-orbitals-1"></a><a class="docs-heading-anchor-permalink" href="#Build-a-tight-binding-Hamiltonian-from-a-set-of-symmetric-orbitals" title="Permalink"></a></h2><p>Second quantization rephrases quantum mechanics in terms of fields and occupation numbers. Instead of tracking individual particles, we describe how many particles occupy each quantum state. This is ideal for many-body physics and that&#39;s why we are going to implement it here.</p><p>In order to do so, we need to introduce a creation and annihilation operators. Since we want to use the basis of orbitals previously introduced, we can define them as:</p><p class="math-container">\[\ket{Ï•_{I,ğ­}} â‰¡ Ä‰^â€ _{I,ğ­} \ket{\text{vac}}\]</p><p>Then, the most general tight-binding Hamiltonian can be written using those operators as:</p><p class="math-container">\[Ä¤ = \sum_{IJ,ğ­ğ­&#39;} h_{IJ,ğ­-ğ­&#39;} Ä‰^â€ _{I,ğ­} Ä‰_{J,ğ­&#39;}\]</p><p>This Hamiltonian reads that the probability of &quot;hopping&quot; from an orbital <span>$\ket{Ï•_{J,ğ­&#39;}}$</span> to an orbital <span>$\ket{Ï•_{I,ğ­}}$</span> is given by the amplitude term <span>$h_{IJ,ğ­-ğ­&#39;}$</span>. Notice that we assumed that the hopping amplitude only depends on the relative distance between both orbitals. This implies that the Hamiltonian will be translational invariant, as it should be. In the following, we are going to refer to that distance as <span>$ğ‘ = ğ­-ğ­&#39;$</span>. Realize that it must be a lattice translation. Using this definition we can rewrite the previous Hamiltonian as:</p><p class="math-container">\[Ä¤ = \sum_{IJ,ğ‘ğ­&#39;} h_{IJ,ğ‘} Ä‰^â€ _{I,ğ‘+ğ­&#39;} Ä‰_{J,ğ­&#39;}\]</p><p>In order to be consistent with the previous choice of the Fourier transform, we obtain that the creation operator in reciprocal space must be related to <span>$Ä‰^â€ _{I,ğ­}$</span> as:</p><p class="math-container">\[\ket{Ï†_{I,ğ¤}} = Ã¢_{I,ğ¤}^â€  \ket{\text{vac}} \\
= \frac{1}{\sqrt{N}} \sum_ğ­ e^{iğ¤Â·(ğ­+ğª_Î±)} \ket{Ï•_{I,ğ­}} = \frac{1}{\sqrt{N}} \sum_ğ­ e^{iğ¤Â·(ğ­+ğª_Î±)} Ä‰_{I,ğ­}^â€  \ket{\text{vac}} \\
â‡’ Ã¢_{I,ğ¤}^â€  = \frac{1}{\sqrt{N}} \sum_ğ­ e^{iğ¤Â·(ğ­+ğª_Î±)} Ä‰_{I,ğ­}^â€ \]</p><p>Notice that since <span>$Ï†_{I,ğ¤+ğ†}(ğ«) = e^{iğ†Â·ğª_Î±} Ï†_{I,ğ¤}(ğ«)$</span>, we also have that <span>$Ã¢_{I,ğ¤+ğ†}^â€  = e^{iğ†Â·ğª_Î±} Ã¢_{I,ğ¤}^â€ $</span>, consistently.</p><p>Considering this, we can rewrite the tight-binding Hamiltonian in reciprocal space as:</p><p class="math-container">\[Ä¤ = \frac{1}{N} \sum_{IJ,ğ‘ğ­&#39;} h_{IJ,ğ‘} \sum_{ğ¤ğ¤&#39;} e^{iğ¤Â·(ğ‘+ğ­&#39;+ğª_Î±)} e^{-iğ¤&#39;Â·(ğ­&#39;+ğª_Î²)} Ã¢_{I,ğ¤}^â€  Ã¢_{J,ğ¤&#39;} \\
= \frac{1}{N} \sum_{IJ,ğ‘ğ­&#39;,ğ¤ğ¤&#39;} h_{IJ,ğ‘} e^{iğ¤Â·(ğ‘+ğª_Î±)} e^{i(ğ¤-ğ¤&#39;)Â·ğ­&#39;} e^{-ğ¤&#39;Â·ğª_Î²} Ã¢_{I,ğ¤}^â€  Ã¢_{J,ğ¤&#39;} \\
= \sum_{IJ,ğ‘,ğ¤} h_{IJ,ğ‘} e^{iğ¤Â·(ğ‘+ğª_Î±-ğª_Î²)} Ã¢_{I,ğ¤}^â€  Ã¢_{J,ğ¤},\]</p><p>where we have used the property of exponential functions: <span>$\sum_{ğ­&#39;} e^{i(ğ¤-ğ¤&#39;)Â·ğ­&#39;} = N Î´_{ğ¤ğ¤&#39;}$</span>.</p><p>Finally, if we define <span>$h_{IJ,ğ¤} = \sum_ğ‘ h_{IJ,ğ‘} e^{iğ¤Â·(ğ‘+ğª_Î±-ğª_Î²)}$</span>, we obtain the usual expression for a tight-binding Hamiltonian in reciprocal space:</p><p class="math-container">\[Ä¤ = \sum_{IJ,ğ¤} h_{IJ,ğ¤} Ã¢_{I,ğ¤}^â€  Ã¢_{J,ğ¤}\]</p><p>As shown, the hopping amplitude in reciprocal space is computed from a summatory of the real space hopping amplitudes for all lattice translations ğ‘. Usually, such summation is cut with some &quot;arbitrary&quot; (subjective) cutoff. One common approach is to just consider a certain number of nearest neighbors. Since we are interested in building a symmetry-constrained tight-binding model, as the symmetry-related terms might not be equal to the number of <span>$n$</span>-th nearest neighbors, we are going to consider a different approach. As we are going to develop later, our strategy will be focus on asking the user to provide a set of ğ‘-vectors where to look, at least, for hopping terms, and then, search for all symmetry-related terms starting from that initial, but potentially not complete, set.</p><p>As can be seen, the tight-binding Hamiltonian is diagonal in reciprocal space. This is due to the assumption that the Hamiltonian must be translational invariant. Then, it is natural to define what is usually called the <em>Bloch Hamiltonian</em> <span>$Ä¤_ğ¤$</span>, which consist on the diagonal blocks in reciprocal space of the tight-binding Hamiltonian:</p><p class="math-container">\[Ä¤_ğ¤ = \sum_{IJ} h_{IJ,ğ¤} Ã¢_{I,ğ¤}^â€  Ã¢_{J,ğ¤}\]</p><p>Some general properties must be fulfilled independent of its representation, such as its periodicity in reciprocal space. However, as shown above, the creation and annihilation operators are not periodic under reciprocal lattice translations and we also have that:</p><p class="math-container">\[h_{IJ,ğ¤+ğ†} = \sum_ğ‘ h_{IJ,ğ‘} e^{i(ğ¤+ğ†)Â·(ğ‘+ğª_Î²-ğª_Î±)} \\
= e^{iğ†Â·(ğª_Î²-ğª_Î±)} \sum_ğ‘ h_{IJ,ğ‘} \cancel{e^{iğ†Â·ğ‘}} e^{iğ¤Â·(ğ‘+ğª_Î²-ğª_Î±)} \\
= e^{iğ†Â·(ğª_Î²-ğª_Î±)} h_{IJ,ğ¤}\]</p><p>However, all these phase factors cancel out in the Bloch Hamiltonian so it is translational invariant in reciprocal space, as can be seeing:</p><p class="math-container">\[Ä¤_{ğ¤+ğ†} = \sum_{IJ} h_{IJ,ğ¤+ğ†} Ã¢_{I,ğ¤+ğ†}^â€  Ã¢_{J,ğ¤+ğ†} \\
= \sum_{IJ} e^{iğ†Â·(ğª_Î²-ğª_Î±)} h_{IJ,ğ¤} e^{iğ†Â·ğª_Î±} Ã¢_{I,ğ¤}^â€  e^{-iğ†Â·ğª_Î²} Ã¢_{J,ğ¤} \\
= \sum_{IJ} h_{IJ,ğ¤} Ã¢_{I,ğ¤}^â€  Ã¢_{J,ğ¤} = Ä¤_ğ¤\]</p><p>Then, we obtain the important translational invariance in reciprocal space of the Bloch Hamiltonian: <span>$Ä¤_{ğ¤+ğ†} = Ä¤_ğ¤$</span>. This property allow us to just consider the first Brillouin zone when we examine the Bloch Hamiltonian.</p><p>The Bloch Hamiltonian can be expressed as a matrix by:</p><p class="math-container">\[Ä¤_ğ¤ = Ã‚_ğ¤^â€  H_ğ¤ Ã‚_ğ¤,\]</p><p>where <span>$Ã‚_ğ¤^â€  = [ Ã¢_{1,ğ¤}^â€ , Ã¢_{2,ğ¤}^â€ , â€¦ ]$</span> is a row vector collecting all creation operators, similarly with <span>$Ã‚_ğ¤$</span>, and <span>$H_ğ¤$</span> is a complex matrix which each entry is defined by: <span>$[H_ğ¤]_{IJ} â‰¡ h_{IJ,ğ¤}$</span>. The matrix <span>$H_ğ¤$</span> is the one we are going to use in our package to compute the eigenvectors and eigenvalues for each ğ¤-point.</p><p>Notice that this matrix <span>$H_ğ¤$</span> is strongly dependent on the Fourier transformation picked. As proved above, within this convention, this matrix is not invariant under reciprocal lattice translations. However, this does not hold under other conventions as exposed in <a href="#appendix-a">Appendix A</a>. This property is not suitable for computing some fundamental properties such as the symmetry eigenvalues, but it will have some computational advantages when encoding the matrix representation <span>$H_ğ¤$</span> in the package.</p><p>Before proceeding, we are going to deduce the constraints that the symmetries of the system impose on the matrix <span>$H_ğ¤$</span>. This will ensure that the model replicates the symmetry and (symmetry-indicated) topology of the system. For that purpose, first, we are going to deduce how the creation and annihilation operators transform under the symmetry operations. Let us start with the creation operator:</p><p class="math-container">\[Ä Ã¢_{I,ğ¤}^â€  Ä^{-1} \ket{\text{vac}} = Ä Ã¢_{I,ğ¤}^â€  \ket{\text{vac}} = Ä \ket{Ï†_{I,ğ¤}} \\
= \sum_J [D_ğ¤(g)]_{JI} \ket{Ï†_{J,gğ¤}} = \sum_J [D_ğ¤(g)]_{JI} Ã¢_{J,gğ¤}^â€  \ket{\text{vac}} \\
â‡’ Ä Ã¢_{I,ğ¤}^â€  Ä^{-1} = \sum_J [D_ğ¤(g)]_{JI} Ã¢_{J,gğ¤}^â€ \]</p><p>Since the symmetry operations <span>$Ä$</span> are unitary, i.e., <span>$Ä^{-1} = Ä^â€ $</span>, we can easily deduce the transformation properties of the annihilation operator from the creation one, and it reads as:</p><p class="math-container">\[Ä Ã¢_{I,ğ¤} Ä^{-1} = \sum_J [D_ğ¤^*(g)]_{JI} Ã¢_{J,gğ¤}\]</p><p>Considering this two transformation properties of the operators, we can deduce the set of relations that the symmetry operations will enforce in the Bloch Hamiltonian. The invariance of the Hamiltonian under symmetry operations reads as:</p><p class="math-container">\[Ä¤ = Ä Ä¤ Ä^{-1}\]</p><p>Expanding the Hamiltonian in terms of the creation and annihilation operator basis leads us to:</p><p class="math-container">\[\sum_{IJ,ğ¤} Ã¢_{I,ğ¤}^â€  h_{IJ,ğ¤} Ã¢_{J,ğ¤} = \sum_{IJ,ğ¤} Ä Ã¢_{I,ğ¤}^â€  h_{IJ,ğ¤} Ã¢_{J,ğ¤} Ä^{-1} \\
= \sum_{IJ,ğ¤} Ä Ã¢_{I,ğ¤}^â€  Ä^{-1} h_{IJ,ğ¤} Ä Ã¢_{J,ğ¤} Ä^{-1} \\
= \sum_{IJ,ğ¤,I&#39;J&#39;} [D_ğ¤(g)]_{I&#39;I} Ã¢_{I&#39;,gğ¤}^â€   h_{IJ,ğ¤} [D_ğ¤^*(g)]_{J&#39;J} Ã¢_{J&#39;,gğ¤} \\
= \sum_{ğ¤,I&#39;J&#39;} Ã¢_{I&#39;,gğ¤}^â€  [D_ğ¤(g) H_ğ¤ D_ğ¤^â€ (g)]_{I&#39;J&#39;} Ã¢_{J&#39;,gğ¤} \\
â‡’ \boxed{H_{gğ¤} = D_ğ¤(g) H_ğ¤ D_ğ¤^â€ (g)}\]</p><p>This symmetry constraints strongly restrict the functional form of <span>$H_ğ¤$</span>. Rather than being a completely general Hermitian (or anti-Hermitian) matrix, <span>$H_ğ¤$</span> must now lie in the subspace of matrices that fulfill the previous constraints. This ensures that the model preserves all symmetries and reproduces the correct degeneracies and connectivity of the original band structure.</p><p>Additionally, as exposed above, the ğ¤-dependence on the representation matrices of operations <span>$D_ğ¤$</span> is only a global phase factor, so it can be dropped in the previous relation. This is really practical in the implementation of the package since the ğ¤-dependence on the previous relation will be just located at the matrix <span>$H_ğ¤$</span> making it easier to encode in non-symbolic programming languages as Julia.</p><p>As stated previously, we are interested on diagonalizing this matrix and find the eigenvectors and eigenvalues associated to it at each ğ¤-point. Those eigenvectors will correspond to a vector of coefficients, associated to the basis set we built the Bloch Hamiltonian on, and will describe the Bloch state of the system at a particular ğ¤-point and energy. In the following section, we will elaborate on this topic and will develop how this Bloch states will transform under the symmetry operations of the system. A sanity check will be to compare the band representation of both, the real system&#39;s band structure and the tight-binding model&#39;s band structure, which should be equal.</p><h3 id="Transformation-properties-of-the-Bloch-states"><a class="docs-heading-anchor" href="#Transformation-properties-of-the-Bloch-states">Transformation properties of the Bloch states</a><a id="Transformation-properties-of-the-Bloch-states-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-properties-of-the-Bloch-states" title="Permalink"></a></h3><p>Until now we have focus on building a symmetry-constrained Hamiltonian to model the band structure of a physical system. Now, we shift our attention to analyze the properties of the Bloch states of the model, which must replicate the band structure of the physical system.</p><p>Let us start by defining the eigenvalue problem from where we start:</p><p class="math-container">\[H_ğ¤ ğ°_{n,ğ¤} = E_{nğ¤} ğ°_{n,ğ¤},\]</p><p>where <span>$\{E_{nğ¤}\}$</span> is the set of eigenvalues (energies) at each ğ¤-point and <span>$\{ğ°_{n,ğ¤}\}$</span> the set of eigenvectors associated to them. Each eigenvector is a vector of coefficients which will correspond to a particular Bloch state in the basis used for describing the Bloch Hamiltonian, i.e.:</p><p class="math-container">\[\ket{Ïˆ_{nğ¤}} = \sum_I w_{I,nğ¤} \ket{Ï†_{I,ğ¤}} = \frac{1}{\sqrt{N}} \sum_{I,ğ­} w_{I,nğ¤} e^{iğ¤Â·(ğ­+ğª_Î±)} \ket{Ï•_{I,ğ­}}\]</p><p>Now that the Bloch states have been defined, we can deduce their transformation properties. First, we are going to analyze their transformation properties under lattice translations in real and reciprocal space, and later, we will analyze their transformation properties under symmetry operation of the space group of the crystal.</p><h4 id="Transformation-properties-under-lattice-translations"><a class="docs-heading-anchor" href="#Transformation-properties-under-lattice-translations">Transformation properties under lattice translations</a><a id="Transformation-properties-under-lattice-translations-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-properties-under-lattice-translations" title="Permalink"></a></h4><p>Here we are going to analyze how the Bloch states of the model transform under lattice translations in real and in reciprocal space. They should transform as Bloch functions transform under these transformations.</p><p>Firstly, let us start with lattice translations in real space:</p><p class="math-container">\[Ïˆ_{nğ¤}(ğ«+ğ‘) = \braket{ğ«+ğ‘|Ïˆ_{nğ¤}} \\
= \frac{1}{\sqrt{N}} \sum_{I,ğ­} w_{I,nğ¤} e^{iğ¤Â·(ğ­+ğª_Î±)} \braket{ğ«+ğ‘|Ï•_{n,ğ­}} \\
= \frac{1}{\sqrt{N}} \sum_{I,ğ­} w_{I,nğ¤} e^{iğ¤Â·(ğ­+ğª_Î±)} \braket{ğ«|Ï•_{n,ğ­-ğ‘}} \\
= e^{iğ¤Â·ğ‘} \frac{1}{\sqrt{N}} \sum_{I,ğ­} w_{I,nğ¤} e^{iğ¤Â·(ğ­-ğ‘+ğª_Î±)} \braket{ğ«|Ï•_{n,ğ­-ğ‘}} \\
= e^{iğ¤Â·ğ‘} \braket{ğ«|Ïˆ_{nğ¤}} = e^{iğ¤Â·ğ‘} Ïˆ_{nğ¤}(ğ«)\]</p><p>The Bloch states transform as Bloch functions under translations in real space, as expected.</p><p>Secondly, let us analyze how they transform under reciprocal lattice translations. Remind that, within this convention, the matrix representation <span>$H_ğ¤$</span> is not periodic under reciprocal lattice translations. This implies that <span>$ğ°_{n,ğ¤}$</span> will not be either, but the eigenvalues <span>$E_{nğ¤}$</span> must be periodic since does are the energies associated to each Bloch state â€” independent of the basis chosen to represent the Hamiltonian. Let us analyze this odd behavior:</p><p class="math-container">\[H_{ğ¤+ğ†} ğ°_{n,ğ¤+ğ†} = E_{n,ğ¤+ğ†} ğ°_{n,ğ¤+ğ†} \\
â‡’ \sum_J h_{IJ,ğ¤+ğ†} w_{Jn,ğ¤+ğ†} = E_{n,ğ¤} w_{In,ğ¤+ğ†} \\
â‡’ \sum_J e^{iğ†Â·(ğª_Î²-ğª_Î±)} h_{IJ,ğ¤} w_{Jn,ğ¤+ğ†} = E_{n,ğ¤} w_{In,ğ¤+ğ†} \\
â‡’ \sum_J h_{IJ,ğ¤} e^{iğ†Â·ğª_Î²} w_{Jn,ğ¤+ğ†} = E_{n,ğ¤} e^{iğ†Â·ğª_Î±} w_{In,ğ¤+ğ†}\]</p><p>Then, this implies that the eigenvectors gain a phase factor we translated in reciprocal space such that:</p><p class="math-container">\[w_{In,ğ¤+ğ†} = e^{-iğ†Â·ğª_Î±} w_{In,ğ¤}\]</p><p>To make this easier, we ca define a diagonal matrix such that <span>$[Î˜_ğ†]_{II} = e^{-iğ†Â·ğª_Î±}$</span>, then the previous expression can be rewritten as:</p><p class="math-container">\[ğ°_{n,ğ¤+ğ†} = Î˜_ğ† ğ°_{n,ğ¤}\]</p><p>Notice that this transformation is not a simple phase factor â€” which is indeterminate on eigenvectors, yet it acts differently in each entry of the eigenvector. This extra factor is crucial when analyzing the invariance of the Bloch states under reciprocal lattice translations, as we will see now.</p><p>Let us deduce how Bloch states will transform under reciprocal lattice translations:</p><p class="math-container">\[\ket{Ïˆ_{n,ğ¤+ğ†}} = \frac{1}{\sqrt{N}} \sum_{I,ğ­} w_{In,ğ¤+ğ†} e^{i(ğ¤+ğ†)Â·(ğ­+ğª_Î±)} \ket{Ï•_{I,ğ­}} \\
= \frac{1}{\sqrt{N}} \sum_{I,ğ­} \cancel{e^{-iğ†Â·ğª_Î±}} w_{In,ğ¤} \cancel{e^{iğ†Â·ğ­}} \cancel{e^{iğ†Â·ğª_Î±}} e^{iğ¤Â·(ğ­+ğª_Î±)} \ket{Ï•_{I,ğ­}} \\
= \frac{1}{\sqrt{N}} \sum_{I,ğ­} w_{In,ğ¤} e^{iğ¤Â·(ğ­+ğª_Î±)} \ket{Ï•_{I,ğ­}} = \ket{Ïˆ_{nğ¤}}\]</p><p>The Bloch states will be invariant under reciprocal lattice translations. This is an important feature and must remain independently of which basis is used for representing the Hamiltonian. This property is proven for another Fourier convention in <a href="#appendix-a">Appendix A</a>.</p><h4 id="Transformation-properties-under-symmetry-operations"><a class="docs-heading-anchor" href="#Transformation-properties-under-symmetry-operations">Transformation properties under symmetry operations</a><a id="Transformation-properties-under-symmetry-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-properties-under-symmetry-operations" title="Permalink"></a></h4><p>Here we analyze how the Bloch states transform under more complex symmetry operations <span>$g = \{R|ğ¯\}$</span> that might involve translations <span>$ğ¯$</span> and site-symmetry operations <span>$R$</span>. The Bloch state will transform under this operations as:</p><p class="math-container">\[Ä \ket{Ïˆ_{nğ¤}} = \sum_I w_{I,nğ¤} Ä \ket{Ï†_{I,ğ¤}} \\
= \sum_{IJ} w_{I,nğ¤} [D_ğ¤(g)]_{JI} \ket{Ï†_{J,gğ¤}} \\
= \sum_{IJ} [D_ğ¤(g)]_{JI} w_{I,nğ¤} \ket{Ï†_{J,gğ¤}}\]</p><p>We are particularly interested in the transformation under operations <span>$Ä$</span> in the little-group <span>$G_ğ¤$</span> of a particular ğ¤-point. This operations will leave invariant the particular ğ¤-point up to a lattice translation, i.e., <span>$g ğ¤ = ğ¤ + ğ†$</span>. How these functions transform under those operations at each high-symmetry point will allow us to assign an irrep to each of the Bloch states at that ğ¤-point. Those should coincide with the ones obtained from the original system&#39;s band structure. The irrep could be assigned by computing the symmetry eigenvalues associated to each Bloch state. Those are compute by:</p><p class="math-container">\[\braket{Ïˆ_{nğ¤}|Ä|Ïˆ_{nğ¤}} = \sum_{IJ} (w_{I,nğ¤})^* w_{J,nğ¤} \braket{Ï†_{I,ğ¤}|Ä|Ï†_{J,ğ¤}} \\
= \sum_{IJJ&#39;} (w_{I,nğ¤})^* w_{J,nğ¤} [D_ğ¤(g)]_{J&#39;J} \braket{Ï†_{I,ğ¤}|Ï†_{J&#39;,gğ¤}} \\
= \sum_{IJJ&#39;} (w_{I,nğ¤})^* w_{J,nğ¤} [D_ğ¤(g)]_{J&#39;J} \braket{Ï†_{I,ğ¤}|Ï†_{J&#39;,ğ¤+ğ†}} \\
= \sum_{IJJ&#39;} (w_{I,nğ¤})^* w_{J,nğ¤} [D_ğ¤(g)]_{J&#39;J} e^{iğ†Â·ğª_{Î²&#39;}} \braket{Ï†_{I,ğ¤}|Ï†_{J&#39;,ğ¤}} \\
= \sum_{IJJ&#39;} (w_{I,nğ¤})^* w_{J,nğ¤} [D_ğ¤(g)]_{J&#39;J} e^{iğ†Â·ğª_{Î²&#39;}} \delta_{IJ&#39;} \\
= \sum_{IJ} (w_{I,nğ¤})^* e^{iğ†Â·ğª_Î±} [D_ğ¤(g)]_{IJ} w_{J,nğ¤}\]</p><p>where we have used how the Bloch functions transform under reciprocal lattice translations â€” a property inherit from the convention choice â€” and their orthogonality.</p><p>Notice that this expression has a phase factor that needs to be accounted for. In other conventions this phase factor does not appears making it easier to compute. Nevertheless, we stick to the current convention due to the property of the ğ¤-dependence in the representation matrices of symmetry operations. However, it is interesting to be able to change from one convention to others. Because of that, we include some functions in the package to be able to change from one convention to another one â€” heavily used in the literature. The relation between these two conventions can be found in <a href="#appendix-a">Appendix A</a>.</p><p>Finally, it is interesting to vectorize the previous expression in order to implemented it in the package. To do so, we make use of the previous phase factor matrix <span>$Î˜_ğ¤$</span>. Making use of it, the previous expression can be written as:</p><p class="math-container">\[\boxed{\braket{Ïˆ_{nğ¤}|Ä|Ïˆ_{nğ¤}} = (Î˜_ğ† ğ°_{nğ¤}) Â· (D_ğ¤(g) ğ°_{nğ¤})}\]</p><h2 id="Appendix-A"><a class="docs-heading-anchor" href="#Appendix-A">Appendix A</a><a id="Appendix-A-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix-A" title="Permalink"></a></h2><p>In this appendix we aim to present, develop and compare two of the main conventions present on the literature for Fourier transforms. The two Fourier transform conventions we are going to analyze are:</p><ol><li><strong>Convention 1:</strong> <span>$Ï†^{(1)}_{I,ğ¤}(ğ«) â‰¡ \sum_ğ­ e^{iğ¤Â·(ğ­+ğª_Î±)} Ï•_I(ğ«-ğ­)$</span></li><li><strong>Convention 2:</strong> <span>$Ï†^{(2)}_{I,ğ¤}(ğ«) â‰¡ \sum_ğ­ e^{iğ¤Â·ğ­} Ï•_I(ğ«-ğ­)$</span></li></ol><p>where Convention 1 is the one we have been using in the theory notes and Convention 2 is another one commonly used in the literature and other packages such as <a href="https://www.nature.com/articles/nature23268">Bradlyn <em>et al.</em></a>. This second convention does not includes the position of the orbital <span>$ğª_Î±$</span> in the phase factor of the Fourier transform.</p><p>The former is the one used in the <a href="https://www.physics.rutgers.edu/pythtb/">PythTB package</a>, where they claim it to be more suitable for computing topological invariants as <a href="https://en.wikipedia.org/wiki/Geometric_phase">Berry phases</a> or <a href="https://en.wikipedia.org/wiki/Wilson_loop">Wilson loops</a>. The later is more common in the literature since it is not necessary to trace back the extra phase factor. Additionally, as we will see later, the later makes easier to compute the symmetry eigenvalues.</p><p>The arguments of which one is better than the other are out of the scope of this notes, so we are going to focus on developing both of them and pointing out their main differences. The package uses â€” for now â€” Convention 1, since it is more suitable for accounting on the ğ¤-dependence, but it also provide several tools to convert its outcome into Convention 2.</p><p>Firstly, we are going to do a similar analysis to the previous one in Convention 1, but now on Convention 2. We are going to analyze the transformation properties of the Bloch functions induced from the orbitals, the effect of this choice on the representation of the Bloch Hamiltonian and its Bloch states. Secondly, we are going to point out the main differences and similarities between both conventions. We aim to point out in which situations one more suitable than the other and when it is irrelevant. Finally, we are going to cover the conversion rules to change to one another â€” which are the ones we implement in this package.</p><h3 id="Transformation-properties-within-Convention-2"><a class="docs-heading-anchor" href="#Transformation-properties-within-Convention-2">Transformation properties within Convention 2</a><a id="Transformation-properties-within-Convention-2-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-properties-within-Convention-2" title="Permalink"></a></h3><p>Firstly, we are going to prove the previous statement: Convention 2 is periodic in reciprocal space, on the contrary, to Convention 1. Let us deduce how a reciprocal lattice translation <span>$ğ†$</span> acts on the Bloch functions under Convention 2:</p><p class="math-container">\[Ï†^{(2)}_{I,ğ¤+ğ†} = \sum_ğ­ e^{i(ğ¤+ğ†)Â·ğ­} Ï•_I(ğ«-ğ­) \\
= \sum_ğ­ \cancel{e^{iğ†Â·ğ­}} e^{iğ¤Â·ğ­} Ï•_I(ğ«-ğ­) \\
= Ï†^{(2)}_{I,ğ¤}\]</p><p>This implies that the Bloch functions are periodic under reciprocal lattice translations within this convention. This has interesting implications in the computation of some parts of this package, such as, the representation of symmetry operations or symmetry eigenvalues. </p><p>Secondly, let us reproduce the transformation properties of the Bloch functions under symmetry operations <span>$g = \{ R|ğ¯ \}$</span> of the space group under Convention 2. Following a similar approach to the one previously developed:</p><p class="math-container">\[g Ï†^{(2)}_{I,ğ¤}(ğ«) = \frac{1}{\sqrt{N}} \sum_ğ­ e^{iğ¤Â·ğ­} g Ï•_{I}(ğ«-ğ­) \\
= \frac{1}{\sqrt{N}} \sum_{ğ­,J} e^{iğ¤Â·ğ­} [Ï(h)]_{JI} Ï•_J(ğ«-Rğ­-ğ­_{Î²Î±}) \\
= \frac{1}{\sqrt{N}} \sum_{ğ­&#39;,J} e^{iğ¤Â·R^{-1}(ğ­&#39;-ğ­_{Î²Î±})} [Ï(h)]_{JI} Ï•_J(ğ«-ğ­&#39;) \\
= e^{-i(g ğ¤)Â·ğ­_{Î²Î±}} \sum_J [Ï(h)]_{JI} \frac{1}{\sqrt{N}} \sum_{ğ­&#39;} e^{i(g ğ¤)Â·ğ­&#39;} Ï•_J(ğ«-ğ­&#39;) \\
= e^{-i(g ğ¤)Â·ğ­_{Î²Î±}} \sum_J [Ï(h)]_{JI} Ï†^{(2)}_{J,g ğ¤}(ğ«),\]</p><p>where we made the substitution <span>$ğ­&#39; = Rğ­ + ğ­_{Î²Î±}$</span>, and used the definition stated before: <span>$gğ¤ â‰¡ [R^{-1}]^T ğ¤$</span>.</p><p>Similarly as before, we can define a representation matrix <span>$D^{(2)}_ğ¤(g)$</span> whose entries are <span>$[D^{(2)}_ğ¤(g)]_{IJ} = e^{-i(gğ¤)Â·ğ­_{Î²Î±}} [Ï(h)]_{IJ}$</span>, where <span>$I = (i,Î±)$</span> and <span>$J = (j,Î²)$</span>. Then, the previous expression reduces to:</p><p class="math-container">\[g Ï†^{(2)}_{I,ğ¤}(ğ«) = \sum_j [D^{(2)}_ğ¤(g)]_{JI} Ï†^{(2)}_{jÎ²,gğ¤}(ğ«)\]</p><p>Notice that the representation matrix for the space group operations differs between conventions, i.e., <span>$D^{(1)}_ğ¤(g) â‰  D^{(2)}_ğ¤(g)$</span>. The representation under Convention 1 depends on the translational part <span>$ğ¯$</span>, as shown before, meanwhile, under Convention 2, it presents not on a global phase factor, but on a local phase factor depending on <span>$ğ­_{Î²Î±}$</span>.</p><p>The next step will be to build a tight-binding model using this set of functions as a basis. For that, in the following section, we will follow the same steps as in Convention 1 by introducing the creation and annihilation operators associated to such functions, and how the Bloch Hamiltonian will look like.</p><h3 id="Bloch-Hamiltonian-under-Convention-2"><a class="docs-heading-anchor" href="#Bloch-Hamiltonian-under-Convention-2">Bloch Hamiltonian under Convention 2</a><a id="Bloch-Hamiltonian-under-Convention-2-1"></a><a class="docs-heading-anchor-permalink" href="#Bloch-Hamiltonian-under-Convention-2" title="Permalink"></a></h3><p>We want to use the previously introduced Bloch functions as a basis to construct a Bloch Hamiltonian in reciprocal space. Once again, we start from the most general tight-binding Hamiltonian, which, as we described, can be written as:</p><p class="math-container">\[Ä¤ = \sum_{IJ,ğ‘ğ­} h_{IJ,ğ‘} Ä‰^â€ _{I,ğ­+ğ‘} Ä‰_{J,ğ­}\]</p><p>Since we want to use the previous Bloch functions as a basis, we have to introduce a set of creation and annihilation operators that are consistent with the convention choice â€” Convention 2 in this case. This is satisfied by the following relation:</p><p class="math-container">\[\hat{b}_{I,ğ¤}^â€  = \frac{1}{\sqrt{N}} \sum_ğ­ e^{iğ¤Â·ğ­} Ä‰_{I,ğ­}^â€ ,\]</p><p>where we have used <span>$\hat{b}$</span> as the notation for the operators under this new convention. It is interesting to notice that you can obtain one from the other by using the following relation:</p><p class="math-container">\[\hat{b}_{I,ğ¤}^â€  = e^{-iğ¤Â·ğª_Î±} Ã¢_{I,ğ¤}^â€ \]</p><p>Introducing the previous transformation into the tight-binding Hamiltonian we obtain that:</p><p class="math-container">\[Ä¤ = \sum_{IJ,ğ‘,ğ¤} h_{IJ,ğ‘} e^{iğ¤Â·ğ‘} \hat{b}_{I,ğ¤}^â€  \hat{b}_{J,ğ¤}\]</p><p>If we define <span>$h^{(2)}_{IJ,ğ¤} = \sum_ğ‘ h_{IJ,ğ‘} e^{iğ¤Â·ğ‘}$</span>, we obtain the usual expression for a tight-binding Hamiltonian in reciprocal space:</p><p class="math-container">\[Ä¤ = \sum_{IJ,ğ¤} h^{(2)}_{IJ,ğ¤} \hat{b}_{I,ğ¤}^â€  \hat{b}_{J,ğ¤}\]</p><p>From here, we can define the Bloch Hamiltonian which will be the diagonal part of the Hamiltonian in reciprocal space, i.e.:</p><p class="math-container">\[Ä¤_ğ¤ = \sum_{IJ} h^{(2)}_{IJ,ğ¤} \hat{b}_{I,ğ¤}^â€  \hat{b}_{J,ğ¤}\]</p><p>Considering that now the Bloch functions are periodic it is easier to prove that the Bloch Hamiltonian is periodic also, but, nevertheless, we are going to prove it. Firstly, let us examine how the creation operator transform under a reciprocal lattice translation:</p><p class="math-container">\[\hat{b}_{I,ğ¤+ğ†}^â€  = \frac{1}{\sqrt{N}} \sum_ğ­ e^{i(ğ¤+ğ†)Â·ğ­} Ä‰_{I,ğ­}^â€  \\
= \frac{1}{\sqrt{N}} \sum_ğ­ \cancel{e^{iğ†Â·ğ­}} e^{iğ¤Â·ğ­} Ä‰_{I,ğ­}^â€  \\
= \hat{b}_{I,ğ¤}^â€ \]</p><p>Secondly, let us study how the coefficients transform under a reciprocal lattice translation:</p><p class="math-container">\[h^{(2)}_{IJ,ğ¤+ğ†} = \sum_ğ‘ h_{IJ,ğ‘} e^{i(ğ¤+ğ†)Â·ğ‘} \\
= \sum_ğ‘ h_{IJ,ğ‘} \cancel{e^{iğ†Â·ğ‘}} e^{iğ¤Â·ğ‘} \\
= h^{(2)}_{IJ,ğ¤}\]</p><p>As can be seen, all the components are periodic within this convention. This is the common reason why it is heavily used in the literature. Proving now the translational invariance of the Bloch Hamiltonian:</p><p class="math-container">\[Ä¤_{ğ¤+ğ†} = \sum_{IJ} h^{(2)}_{IJ,ğ¤+ğ†} \hat{b}_{I,ğ¤+ğ†}^â€  \hat{b}_{J,ğ¤+ğ†} \\
= \sum_{IJ} h^{(2)}_{IJ,ğ¤} \hat{b}_{I,ğ¤}^â€  \hat{b}_{J,ğ¤} = Ä¤_ğ¤\]</p><p>This is an important property since the eigenvalues of this Bloch Hamiltonian, which correspond to the energies of the Bloch states of the system, must be periodic in reciprocal space, allowing us to restrict to the first Brillouin zone. Additionally, since the representation matrix <span>$H_ğ¤$</span> is now periodic by itself, the eigenvectors <span>$ğ°^{(2)}_{nğ¤}$</span> will also be periodic. This has important implications, for example, when computing the symmetry eigenvalues.</p><p>Before studying the transformation properties of the Bloch states, we want to mention that the creation and annihilation operators and the Bloch Hamiltonian within this convention will have the same transformation properties under symmetry operations but now using the representation matrix of the operations <span>$D^{(2)}_ğ¤$</span> associated to Convention 2.</p><h4 id="Bloch-states-under-Convention-2"><a class="docs-heading-anchor" href="#Bloch-states-under-Convention-2">Bloch states under Convention 2</a><a id="Bloch-states-under-Convention-2-1"></a><a class="docs-heading-anchor-permalink" href="#Bloch-states-under-Convention-2" title="Permalink"></a></h4><p>Let us now jump into the transformation properties of the Bloch states. The Bloch states are represented using the basis obtained by Convention 2 as:</p><p class="math-container">\[\ket{Ïˆ_{nğ¤}} = \sum_I w^{(2)}_{I,nğ¤} \ket{Ï†^{(2)}_{I,ğ¤}} = \frac{1}{\sqrt{N}} \sum_{I,ğ­} w^{(2)}_{I,nğ¤} e^{iğ¤Â·(ğ­+ğª_Î±)} \ket{Ï•_{I,ğ­}}\]</p><p>Let us first study how the Bloch states transform under lattice translations in real and reciprocal space and, then, deduce how they transform under more complex symmetry operations.</p><h5 id="Transformation-under-lattice-translations"><a class="docs-heading-anchor" href="#Transformation-under-lattice-translations">Transformation under lattice translations</a><a id="Transformation-under-lattice-translations-1"></a><a class="docs-heading-anchor-permalink" href="#Transformation-under-lattice-translations" title="Permalink"></a></h5><p>Firstly, we are going to consider lattice translations in real space. This can be obtained by:</p><p class="math-container">\[Ïˆ_{nğ¤}(ğ«+ğ‘) = \braket{ğ«+ğ‘|Ïˆ_{nğ¤}} \\
= \frac{1}{\sqrt{N}} \sum_{I,ğ­} w^{(2)}_{I,nğ¤} e^{iğ¤Â·ğ­} \braket{ğ«+ğ‘|Ï•_{n,ğ­}} \\
= \frac{1}{\sqrt{N}} \sum_{I,ğ­} w^{(2)}_{I,nğ¤} e^{iğ¤Â·ğ­} \braket{ğ«|Ï•_{n,ğ­-ğ‘}} \\
= e^{iğ¤Â·ğ‘} \frac{1}{\sqrt{N}} \sum_{I,ğ­} w^{(2)}_{I,nğ¤} e^{iğ¤Â·(ğ­-ğ‘)} \braket{ğ«|Ï•_{n,ğ­-ğ‘}} \\
= e^{iğ¤Â·ğ‘} \braket{ğ«|Ïˆ_{nğ¤}} = e^{iğ¤Â·ğ‘} Ïˆ_{nğ¤}(ğ«)\]</p><p>The Bloch states transform as Bloch functions under translations in real space, as expected.</p><p>Secondly, let us analyze how they transform under reciprocal lattice translations. Remind that the matrix representation <span>$H^{(2)}_ğ¤$</span> is periodic under reciprocal lattice translations. This implies that <span>$ğ°^{(2)}_{n,ğ¤+ğ†} = ğ°^{(2)}_{n,ğ¤}$</span>, and <span>$E_{n,ğ¤+ğ†} = E_{n,ğ¤}$</span>, i.e., they are periodic under reciprocal lattice translations.</p><p>Let us deduce how Bloch states will transform under reciprocal lattice translations:</p><p class="math-container">\[\ket{Ïˆ_{n,ğ¤+ğ†}} = \frac{1}{\sqrt{N}} \sum_{I,ğ­} w^{(2)}_{In,ğ¤+ğ†} e^{i(ğ¤+ğ†)Â·ğ­} \ket{Ï•_{I,ğ­}} \\
= \frac{1}{\sqrt{N}} \sum_{I,ğ­} w^{(2)}_{In,ğ¤} \cancel{e^{iğ†Â·ğ­}} e^{iğ¤Â·ğ­} \ket{Ï•_{I,ğ­}} \\
= \frac{1}{\sqrt{N}} \sum_{I,ğ­} w^{(2)}_{In,ğ¤} e^{iğ¤Â·ğ­} \ket{Ï•_{I,ğ­}} = \ket{Ïˆ_{nğ¤}}\]</p><p>The Bloch states will remain invariant under reciprocal lattice translations, as it should be.</p><h5 id="Transformation-properties-under-symmetry-operations-2"><a class="docs-heading-anchor" href="#Transformation-properties-under-symmetry-operations-2">Transformation properties under symmetry operations</a><a class="docs-heading-anchor-permalink" href="#Transformation-properties-under-symmetry-operations-2" title="Permalink"></a></h5><p>Here we analyze how the Bloch states transform under more complex symmetry operations <span>$g = \{R|ğ¯\}$</span> that might involve translations <span>$ğ¯$</span> and site-symmetry operations <span>$R$</span>. The Bloch state will transform under this operations as:</p><p class="math-container">\[Ä \ket{Ïˆ_{nğ¤}} = \sum_I w^{(2)}_{I,nğ¤} Ä \ket{Ï†^{(2)}_{I,ğ¤}} \\
= \sum_{IJ} w^{(2)}_{I,nğ¤} [D^{(2)}_ğ¤(g)]_{JI} \ket{Ï†^{(2)}_{J,gğ¤}} \\
= \sum_{IJ} [D^{(2)}_ğ¤(g)]_{JI} w^{(2)}_{I,nğ¤} \ket{Ï†^{(2)}_{J,gğ¤}}\]</p><p>We are particularly interested in the transformation under operations <span>$Ä$</span> in the little-group <span>$G_ğ¤$</span> of a particular ğ¤-point. This operations will leave invariant the particular ğ¤-point up to a lattice translation, i.e., <span>$g ğ¤ = ğ¤ + ğ†$</span>. How these functions transform under those operation at each high-symmetry point will allow us to assign an irrep to each of the Bloch states at that ğ¤-point. Those should coincide with the ones obtained from the original system&#39;s band structure. The irrep could be assigned by computing the symmetry eigenvalues associated to each Bloch state. Those are compute by:</p><p class="math-container">\[\braket{Ïˆ_{nğ¤}|Ä|Ïˆ_{nğ¤}} = \sum_{IJ} (w^{(2)}_{I,nğ¤})^* w^{(2)}_{J,nğ¤} \braket{Ï†^{(2)}_{I,ğ¤}|Ä|Ï†^{(2)}_{J,ğ¤}} \\
= \sum_{IJJ&#39;} (w^{(2)}_{I,nğ¤})^* w^{(2)}_{J,nğ¤} [D^{(2)}_ğ¤(g)]_{J&#39;J} \braket{Ï†^{(2)}_{I,ğ¤}|Ï†^{(2)}_{J&#39;,gğ¤}} \\
= \sum_{IJJ&#39;} (w^{(2)}_{I,nğ¤})^* w^{(2)}_{J,nğ¤} [D^{(2)}_ğ¤(g)]_{J&#39;J} \braket{Ï†^{(2)}_{I,ğ¤}|Ï†^{(2)}_{J&#39;,ğ¤+ğ†}} \\
= \sum_{IJJ&#39;} (w^{(2)}_{I,nğ¤})^* w^{(2)}_{J,nğ¤} [D^{(2)}_ğ¤(g)]_{J&#39;J} \braket{Ï†^{(2)}_{I,ğ¤}|Ï†^{(2)}_{J&#39;,ğ¤}} \\
= \sum_{IJJ&#39;} (w^{(2)}_{I,nğ¤})^* w^{(2)}_{J,nğ¤} [D^{(2)}_ğ¤(g)]_{J&#39;J} \delta_{IJ&#39;} \\
= \sum_{IJ} (w^{(2)}_{I,nğ¤})^* [D_ğ¤(g)]_{IJ} w^{(2)}_{J,nğ¤}\]</p><p>Notice that this expression differs from the previous one due to a phase factor. This is the main reason why some authors decided to use Convention 2 instead Convention 1: it is not necessary to account for phase factors in the symmetry eigenvalues computations.</p><p>Nevertheless, it is interesting to be able to consider both conventions and that is why, in the next section, we develop conversion properties between the two conventions for several convention-dependent expressions.</p><h3 id="Conversions-between-Convention-1-and-2"><a class="docs-heading-anchor" href="#Conversions-between-Convention-1-and-2">Conversions between Convention 1 and 2</a><a id="Conversions-between-Convention-1-and-2-1"></a><a class="docs-heading-anchor-permalink" href="#Conversions-between-Convention-1-and-2" title="Permalink"></a></h3><p>Firstly, ley us start with the conversion between the Bloch functions that the different Fourier transformations inherit. Since there is just an additional phase factor, we can just convert from one convention to the other adding that extra factor as:</p><p class="math-container">\[\ket{Ï†^{(2)}_{I,ğ¤}} = e^{-iğ¤Â·ğª_Î±} \ket{Ï†^{(1)}_{I,ğ¤}}\]</p><p>Obviously, the creation and annihilation operators will convert in a similar fashion, in particular, as said previously:</p><p class="math-container">\[\hat{b}_{I,ğ¤}^â€  = e^{-iğ¤Â·ğª_Î±} Ã¢_{I,ğ¤}^â€ \]</p><p>Secondly, the Hamiltonian must be invariant independent of what basis we use to define it. Considering this, we can deduce how the matrix <span>$H_ğ¤$</span>, which is representation dependent, convert from one convention to the other. Let us start with the Bloch Hamiltonian:</p><p class="math-container">\[Ä¤_ğ¤ = \sum_{IJ} h^{(1)}_{IJ,ğ¤} Ã¢_{I,ğ¤}^â€  Ã¢_{J,ğ¤} \\
= \sum_{IJ} e^{iğ¤Â·ğª_Î±} h^{(1)}_{IJ,ğ¤} e^{-iğ¤Â·ğª_Î²} \hat{b}_{I,ğ¤}^â€  \hat{b}_{J,ğ¤} \\
â‡’ h^{(2)}_{IJ,ğ¤} = e^{iğ¤Â·ğª_Î±} h^{(1)}_{IJ,ğ¤} e^{-iğ¤Â·ğª_Î²}\]</p><p>This allow us to convert from one representation matrix of the Hamiltonian to the other. It is more interesting to rewrite the previous relation in matrix form, which will be:</p><p class="math-container">\[H^{(2)}_ğ¤ = Î˜^â€ _ğ¤ H^{(1)}_ğ¤ Î˜_ğ¤,\]</p><p>where <span>$Î˜_ğ¤$</span> is a diagonal matrix containing the phase factor as defined previously: <span>$[Î˜_ğ¤]_{II} = e^{-iğ¤Â·ğª_Î±}$</span>. This relation allow us to transform from one representation of the Bloch Hamiltonian into the other.</p><p>Finally, we are interested in deducing the conversion properties of the eigenvector obtained from diagonalizing the representation matrix <span>$H_ğ¤$</span>. Since <span>$H^{(1)}_ğ¤$</span> and <span>$H^{(2)}_ğ¤$</span> are related by a change of basis, the eigenvalue of both of them can be easily related to one each other as:</p><p class="math-container">\[ğ°^{(2)}_{nğ¤} = Î˜^â€ _ğ¤ ğ°^{(1)}_{nğ¤}\]</p><p>With this relations we are able to to go back and forward from one convention to the other, making it possible to use both depending on which one is the most suitable for each case.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">Â« Home</a><a class="docs-footer-nextpage" href="../tutorial/">Tutorial Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 4 August 2025 09:28">Monday 4 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
